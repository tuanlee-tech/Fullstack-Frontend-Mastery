
## 🍽️ **PROJECT 2: Smart Meal Planner**

### 📖 **Project Overview**
Ứng dụng lập kế hoạch bữa ăn thông minh giúp người dùng tìm công thức nấu ăn phù hợp với ngân sách, lượng calo mục tiêu, và nguyên liệu sẵn có. Giải quyết vấn đề: "Hôm nay ăn gì? Làm sao ăn đủ dinh dưỡng mà tiết kiệm?"

### 🎯 **Target Users**
- Người bận rộn không có thời gian nghĩ thực đơn
- Người tập gym cần track calories
- Người sống tiết kiệm, quản lý ngân sách chặt
- Người muốn ăn đủ dinh dưỡng
- Gia đình muốn đa dạng món ăn

### 🚀 **MVP - Week 1-2 (Core Features)**

**User Story 1: User Preferences Setup**
```
AS A new user
I WANT TO set my dietary preferences
SO THAT I get personalized meal suggestions
```
**Acceptance Criteria:**
- ✅ Onboarding wizard (3 steps)
- ✅ Step 1: Daily budget (VND or USD)
- ✅ Step 2: Calorie goal (with calculator: gender, age, weight, activity level)
- ✅ Step 3: Dietary restrictions (vegetarian, vegan, gluten-free, halal, etc.)
- ✅ Save preferences
- ✅ Skip onboarding (use defaults)

**User Story 2: Daily Meal Suggestions**
```
AS A user
I WANT TO see meal suggestions for today
SO THAT I know what to cook
```
**Acceptance Criteria:**
- ✅ Generate 3 meals: Breakfast, Lunch, Dinner
- ✅ Each meal shows: Image, Name, Calories, Estimated cost, Cooking time
- ✅ Total daily calories displayed
- ✅ Total daily cost displayed
- ✅ Refresh button to get new suggestions
- ✅ Suggestions based on user preferences
- ✅ "I don't like this" button (replace meal)

**User Story 3: Recipe Details**
```
AS A user
I WANT TO see detailed recipe information
SO THAT I can cook the meal
```
**Acceptance Criteria:**
- ✅ Ingredients list with quantities
- ✅ Step-by-step instructions
- ✅ Nutritional information (calories, protein, carbs, fats)
- ✅ Cooking time (prep + cook)
- ✅ Serving size
- ✅ Recipe image (high quality)
- ✅ Difficulty level (Easy, Medium, Hard)

**User Story 4: Save Favorite Recipes**
```
AS A user
I WANT TO save recipes I like
SO THAT I can easily find them later
```
**Acceptance Criteria:**
- ✅ Heart icon to save recipe
- ✅ "My Favorites" page
- ✅ Grid view with images
- ✅ Unsave recipe
- ✅ Empty state message

**User Story 5: Basic Search**
```
AS A user
I WANT TO search for specific recipes
SO THAT I can find what I'm craving
```
**Acceptance Criteria:**
- ✅ Search by recipe name or ingredient
- ✅ Filter by meal type (breakfast, lunch, dinner, snack)
- ✅ Filter by cuisine (Vietnamese, Italian, Chinese, etc.)
- ✅ Filter by cooking time (< 15 min, 15-30 min, > 30 min)
- ✅ Sort by: Relevance, Calories (low to high), Cost (low to high)
- ✅ Show result count
- ✅ Pagination (20 results per page)

**Database Schema (MVP):**
```prisma
model User {
  id                String         @id @default(cuid())
  email             String         @unique
  name              String
  dailyBudget       Decimal?       @db.Decimal(10, 2)
  dailyCalories     Int?
  dietaryPrefs      String[]       // ["vegetarian", "gluten-free"]
  savedRecipes      SavedRecipe[]
  mealPlans         MealPlan[]
  pantryItems       PantryItem[]
  createdAt         DateTime       @default(now())
}

model SavedRecipe {
  id          String   @id @default(cuid())
  userId      String
  recipeId    String   // External API ID
  recipeName  String
  recipeData  Json     // Cache full recipe
  imageUrl    String?
  calories    Int
  cost        Decimal  @db.Decimal(10, 2)
  createdAt   DateTime @default(now())
  
  @@unique([userId, recipeId])
}

model MealPlan {
  id            String   @id @default(cuid())
  userId        String
  date          DateTime
  breakfast     Json?    // { recipeId, recipeName, calories, cost }
  lunch         Json?
  dinner        Json?
  snacks        Json?
  totalCalories Int
  totalCost     Decimal  @db.Decimal(10, 2)
  createdAt     DateTime @default(now())
  
  @@unique([userId, date])
}

model PantryItem {
  id          String    @id @default(cuid())
  userId      String
  name        String
  quantity    String    // "500g", "2 cups"
  unit        String
  category    String    // "Vegetables", "Meat", "Grains"
  expiryDate  DateTime?
  createdAt   DateTime  @default(now())
}
```

---

### 📈 **Phase 2 - Week 3 (Enhanced Features)**

**Feature 1: Pantry Management**
```
AS A user
I WANT TO track ingredients I already have
SO THAT the app suggests recipes using my pantry items
```
**Acceptance Criteria:**
- ✅ Add pantry item (name, quantity, expiry date, category)
- ✅ List all pantry items grouped by category
- ✅ Edit/Delete pantry items
- ✅ Quick add from ingredient list (while viewing recipe)
- ✅ Expiry date alerts (items expiring in 3 days)
- ✅ "Use up" mode: Recipes using items about to expire

**Feature 2: Recipes Based on Pantry**
```
AS A user
I WANT TO see recipes I can cook with what I have
SO THAT I reduce food waste and grocery trips
```
**Acceptance Criteria:**
- ✅ "Cook from pantry" button
- ✅ Algorithm: Find recipes with max pantry ingredient match
- ✅ Show match percentage (e.g., "You have 8/10 ingredients")
- ✅ Highlight missing ingredients
- ✅ Option to add missing ingredients to shopping list

**Feature 3: Shopping List Generation**
```
AS A user
I WANT TO generate a shopping list from my meal plan
SO THAT I know exactly what to buy
```
**Acceptance Criteria:**
- ✅ Select meals for the week
- ✅ Auto-generate shopping list (aggregated ingredients)
- ✅ Subtract pantry items (if enabled)
- ✅ Group by category (Vegetables, Meat, Dairy, etc.)
- ✅ Check off items as you shop
- ✅ Add custom items manually
- ✅ Share shopping list (WhatsApp, SMS, Email)
- ✅ Print-friendly view

**Feature 4: Weekly Meal Planning**
```
AS A user
I WANT TO plan meals for the whole week
SO THAT I can shop once and save time
```
**Acceptance Criteria:**
- ✅ Calendar view (7 days)
- ✅ Drag & drop recipes to days
- ✅ Auto-generate weekly plan (button)
- ✅ Balance variety (no repeated ingredients)
- ✅ Stay within weekly budget
- ✅ Weekly calorie average chart
- ✅ Copy week to next week
- ✅ Share meal plan (PDF export)

**Feature 5: Nutritional Insights**
```
AS A user
I WANT TO see my nutritional intake over time
SO THAT I ensure balanced diet
```
**Acceptance Criteria:**
- ✅ Daily nutrition breakdown (calories, protein, carbs, fats, fiber)
- ✅ Weekly average chart
- ✅ Compare to recommended intake
- ✅ Highlight deficiencies (e.g., "Low protein this week")
- ✅ Macro ratio pie chart
- ✅ Micronutrients (vitamins, minerals) - optional

---

### 🚀 **Phase 3 - Week 4 (Advanced Features)**

**Feature 1: Custom Recipe Creation**
```
AS A user
I WANT TO add my own recipes
SO THAT I can save family recipes
```
**Acceptance Criteria:**
- ✅ Rich text editor for instructions
- ✅ Ingredient list builder (add/remove rows)
- ✅ Upload recipe image
- ✅ Calculate nutritional info (from ingredients)
- ✅ Estimate cost (from ingredient prices)
- ✅ Set cooking time, difficulty, servings
- ✅ Tag recipe (Vietnamese, quick, healthy, etc.)
- ✅ Share recipe with community (optional)

**Feature 2: Recipe Scaling**
```
AS A user
I WANT TO adjust recipe serving size
SO THAT I can cook for different numbers of people
```
**Acceptance Criteria:**
- ✅ Dropdown: 1, 2, 4, 6, 8 servings
- ✅ Auto-scale all ingredient quantities
- ✅ Adjust cooking time (if needed)
- ✅ Recalculate nutrition per serving

**Feature 3: Meal Prep Mode**
```
AS A user
I WANT TO plan batch cooking sessions
SO THAT I can prepare meals in advance
```
**Acceptance Criteria:**
- ✅ Select recipes that store well (3-5 days)
- ✅ Batch cooking suggestions (make 4 servings, eat over 2 days)
- ✅ Prep timeline (Sunday: cook these 3 recipes)
- ✅ Storage tips (containers, labeling)
- ✅ Reheating instructions

**Feature 4: Grocery Delivery Integration**
```
AS A user
I WANT TO order ingredients directly
SO THAT I save time going to the market
```
**Acceptance Criteria:**
- ✅ Connect to grocery delivery API (e.g., Grab, Now, Baemin)
- ✅ One-click add shopping list to cart
- ✅ Price comparison between stores
- ✅ Track delivery status

**Feature 5: Social Features**
```
AS A user
I WANT TO share my meal plans with family
SO THAT everyone knows what's for dinner
```
**Acceptance Criteria:**
- ✅ Share weekly meal plan (link)
- ✅ Family/Household account (multiple users)
- ✅ Voting system (family votes on meals)
- ✅ Comments on recipes
- ✅ Cook this together" - collaborative cooking

**Feature 6: AI-Powered Suggestions**
```
AS A user
I WANT TO get smart meal recommendations
SO THAT I discover new recipes suited to my taste
```
**Acceptance Criteria:**
- ✅ Learn from user favorites (ML recommendation)
- ✅ "You might also like" suggestions
- ✅ Seasonal ingredient suggestions
- ✅ Budget optimization tips
- ✅ Leftover management (use yesterday's rice in today's fried rice)

---

### 🎨 **UI/UX Requirements**

**Design Principles:**
- Appetite appeal (beautiful food images)
- Quick interaction (add to meal plan in 1 click)
- Visual nutrition info (color-coded macros)
- Mobile-optimized (most users cook from phone)

**Key Screens:**
1. **Home/Dashboard** - Today's meal suggestions
2. **Discover** - Search & browse recipes
3. **Meal Planner** - Weekly calendar view
4. **Pantry** - Ingredient inventory
5. **Shopping List** - Checklist with categories
6. **My Recipes** - Saved & custom recipes
7. **Settings** - Preferences, dietary restrictions

**Color Scheme:**
- Primary: Orange (#F97316) - appetite stimulation
- Secondary: Green (#10B981) - healthy, fresh
- Accent: Yellow (#FBBF24) - warm, inviting
- Background: Cream (#FFFBEB) - soft, appetizing

---

### 🧪 **Testing Strategy**

**Unit Tests:**
- Calorie calculation from ingredients
- Budget estimation logic
- Recipe matching algorithm (pantry)
- Shopping list aggregation
- Serving size scaling

**Integration Tests:**
- External API integration (recipe APIs)
- Image upload & optimization
- PDF generation (meal plan export)
- Calendar date handling (timezones)

**E2E Tests:**
```typescript
test('User can plan a week of meals and generate shopping list', async ({ page }) => {
  await page.goto('/meal-planner')
  
  // Add meals to calendar
  await page.click('[data-day="monday"] [data-meal="breakfast"]')
  await page.click('text=Pho Bo')
  await page.click('text=Add to Plan')
  
  // Repeat for other meals...
  
  // Generate shopping list
  await page.click('text=Generate Shopping List')
  await expect(page.locator('text=Rice noodles')).toBeVisible()
  await expect(page.locator('text=Beef')).toBeVisible()
})
```

---

### 📊 **Success Metrics**

**Technical:**
- Recipe search < 500ms
- Image load time < 1s (optimized)
- API cache hit rate > 80%
- Offline recipe viewing (PWA)

**User Experience:**
- Time to plan a week < 5 minutes
- Shopping list generation < 3 seconds
- Recipe satisfaction rate > 80%

**Business:**
- Weekly active users
- Recipes saved per user (avg > 10)
- Meal plans created per week
- Feature usage (pantry, shopping list)

---

### 🔌 **API Integration**

**Recipe APIs:**
- **Spoonacular** (primary) - 150 requests/day free
- **Edamam** (backup) - 10,000 requests/month free
- **USDA FoodData Central** - nutritional data

**API Caching Strategy:**
- Cache recipe search results (1 hour)
- Cache recipe details (24 hours)
- Cache nutritional data (permanent)
- Reduce API costs

---

### 🚀 **Deployment Considerations**

**Performance Optimization:**
- Next.js Image optimization (recipe images)
- ISR for popular recipes (regenerate daily)
- Edge caching for recipe data
- Lazy load recipe images

**SEO Strategy:**
- Each recipe = separate page (dynamic routes)
- Meta tags (recipe name, description)
- JSON-LD structured data (Recipe schema)
- Sitemap generation (popular recipes)
- OG images (recipe photos)

---