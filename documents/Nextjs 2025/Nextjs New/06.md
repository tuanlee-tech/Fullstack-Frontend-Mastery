

# ğŸ§­ **Nested Routes trong Next.js**

## ğŸ¯ Má»¥c tiÃªu

Hiá»ƒu cÃ¡ch Next.js cho phÃ©p ta táº¡o **route lá»“ng nhau** chá»‰ báº±ng cÃ¡ch lá»“ng thÆ° má»¥c,
vÃ  **layout chaâ€“con** sáº½ tá»± Ä‘á»™ng bao bá»c cÃ¡c trang con tÆ°Æ¡ng á»©ng.

---

## ğŸ§± 1ï¸âƒ£ Cáº¥u trÃºc thÆ° má»¥c thá»ƒ hiá»‡n route hierarchy

**Trong App Router, â€œNested Routesâ€ = ThÆ° má»¥c lá»“ng nhau.**

VÃ­ dá»¥:

```
app/
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ analytics/
â”‚       â””â”€â”€ page.tsx
```

â¡ Káº¿t quáº£ URL:

| URL                    | File                               |
| ---------------------- | ---------------------------------- |
| `/dashboard`           | `app/dashboard/page.tsx`           |
| `/dashboard/analytics` | `app/dashboard/analytics/page.tsx` |

---

## ğŸ§© 2ï¸âƒ£ **layout.tsx** Ä‘Ã³ng vai trÃ² *wrapper layout* cho táº¥t cáº£ route con

Náº¿u báº¡n cÃ³ `layout.tsx` trong `dashboard/`,
Next.js sáº½ **render layout Ä‘Ã³ cho cáº£ /dashboard vÃ  cÃ¡c route con bÃªn trong**.

```tsx
// app/dashboard/layout.tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <section
      style={{
        border: "2px solid #ccc",
        borderRadius: 8,
        padding: "1rem",
        marginTop: "1rem",
      }}
    >
      <h2>ğŸ“Š Dashboard Layout</h2>
      <nav style={{ display: "flex", gap: "1rem" }}>
        <a href="/dashboard">Overview</a>
        <a href="/dashboard/analytics">Analytics</a>
      </nav>
      <hr />
      {children}
    </section>
  );
}
```

---

## ğŸ“„ 3ï¸âƒ£ **Dashboard Page**

```tsx
// app/dashboard/page.tsx
export default function DashboardPage() {
  return (
    <div>
      <h3>Dashboard Overview</h3>
      <p>Welcome to your dashboard summary view.</p>
    </div>
  );
}
```

---

## ğŸ“„ 4ï¸âƒ£ **Nested Route Page**

```tsx
// app/dashboard/analytics/page.tsx
export default function AnalyticsPage() {
  return (
    <div>
      <h3>Analytics Section</h3>
      <p>Here you can see user engagement and metrics.</p>
    </div>
  );
}
```

---

## ğŸ§  5ï¸âƒ£ **Khi render, Next.js lÃ m gÃ¬?**

Khi báº¡n vÃ o `/dashboard/analytics`:

1. Next.js **render `app/layout.tsx` (root layout)**
2. Rá»“i render **`app/dashboard/layout.tsx` (nested layout)**
3. Cuá»‘i cÃ¹ng lÃ  **`app/dashboard/analytics/page.tsx` (page con)**

ğŸ§© Cáº¥u trÃºc káº¿t há»£p:

```tsx
<html>
  <body>
    {/* Root Layout */}
    <header>...</header>

    {/* Dashboard Layout */}
    <section>
      <h2>Dashboard Layout</h2>
      <nav>...</nav>

      {/* Nested Page */}
      <h3>Analytics Section</h3>
      <p>...</p>
    </section>
  </body>
</html>
```

---

## ğŸ’¬ 6ï¸âƒ£ **Äiá»u tuyá»‡t vá»i cá»§a Nested Layouts**

* KhÃ´ng cáº§n â€œprops drillingâ€ layout xuá»‘ng tá»«ng component.
* Dá»… quáº£n lÃ½ vÃ¹ng giao diá»‡n riÃªng biá»‡t cho tá»«ng pháº§n á»©ng dá»¥ng.
* Layout cha Ä‘Æ°á»£c **giá»¯ nguyÃªn state** khi chuyá»ƒn giá»¯a route con â†’ khÃ´ng bá»‹ reload.

---

## ğŸ§© **BÃ i táº­p nhá»**

> Táº¡o cáº¥u trÃºc `/dashboard` gá»“m:
>
> * `/dashboard` â†’ hiá»ƒn thá»‹ overview.
> * `/dashboard/settings` â†’ hiá»ƒn thá»‹ pháº§n cÃ i Ä‘áº·t.
> * Cáº£ hai dÃ¹ng chung layout cÃ³ sidebar vÃ  tiÃªu Ä‘á» â€œDashboard Panelâ€.
> * Khi chuyá»ƒn giá»¯a 2 trang, sidebar giá»¯ nguyÃªn (khÃ´ng bá»‹ reload).


## ğŸ§± Cáº¥u trÃºc thÆ° má»¥c

```
app/
â”œâ”€â”€ layout.tsx
â”œâ”€â”€ page.tsx
â””â”€â”€ dashboard/
    â”œâ”€â”€ layout.tsx        â† layout con cho dashboard
    â”œâ”€â”€ page.tsx          â† /dashboard
    â””â”€â”€ settings/
        â””â”€â”€ page.tsx      â† /dashboard/settings
```

---

## `app/dashboard/layout.tsx`

```tsx
"use client"; // cho phÃ©p dÃ¹ng useState Ä‘á»ƒ giá»¯ sidebar state

import { useState } from "react";
import Link from "next/link";

export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const [collapsed, setCollapsed] = useState(false);

  return (
    <section
      style={{
        display: "flex",
        border: "2px solid #ccc",
        borderRadius: 8,
        marginTop: "1rem",
        minHeight: "60vh",
      }}
    >
      {/* Sidebar */}
      <aside
        style={{
          width: collapsed ? "80px" : "220px",
          transition: "all 0.3s ease",
          background: "#f3f4f6",
          padding: "1rem",
          borderRight: "1px solid #e5e7eb",
        }}
      >
        <button
          onClick={() => setCollapsed(!collapsed)}
          style={{
            background: "#111827",
            color: "white",
            border: "none",
            borderRadius: 4,
            padding: "0.5rem 1rem",
            marginBottom: "1rem",
            cursor: "pointer",
            width: "100%",
          }}
        >
          {collapsed ? "â¡ï¸" : "â¬…ï¸ Collapse"}
        </button>

        {!collapsed && (
          <nav style={{ display: "flex", flexDirection: "column", gap: 12 }}>
            <Link href="/dashboard">ğŸ  Overview</Link>
            <Link href="/dashboard/settings">âš™ï¸ Settings</Link>
          </nav>
        )}
      </aside>

      {/* Content area */}
      <div style={{ flex: 1, padding: "1.5rem" }}>
        <h2 style={{ borderBottom: "1px solid #ddd", paddingBottom: "0.5rem" }}>
          ğŸ“Š Dashboard Panel
        </h2>
        <div style={{ marginTop: "1rem" }}>{children}</div>
      </div>
    </section>
  );
}
```

---

## `app/dashboard/page.tsx`

```tsx
export default function DashboardOverviewPage() {
  return (
    <div>
      <h3>Overview</h3>
      <p>Welcome to your main dashboard. Hereâ€™s the summary of your data.</p>
    </div>
  );
}
```

---

## `app/dashboard/settings/page.tsx`

```tsx
export default function DashboardSettingsPage() {
  return (
    <div>
      <h3>Settings</h3>
      <p>Here you can manage your profile and preferences.</p>
    </div>
  );
}
```

---

## âœ… Giáº£i thÃ­ch

* `layout.tsx` trong `dashboard/` lÃ  **nested layout**, sáº½ bá»c táº¥t cáº£ route con (`/dashboard`, `/dashboard/settings`, â€¦).
* Khi báº¡n chuyá»ƒn giá»¯a `/dashboard` vÃ  `/dashboard/settings`, Next.js:

  1. KhÃ´ng reload láº¡i `layout.tsx`
  2. Giá»¯ nguyÃªn sidebar & state (`collapsed`)
  3. Chá»‰ thay Ä‘á»•i pháº§n `{children}` bÃªn pháº£i

=> ÄÃ¢y lÃ  cÆ¡ cháº¿ **Nested Routing + Persistent Layout** â€” má»™t trong nhá»¯ng Ä‘iá»ƒm **Next.js App Router vÆ°á»£t trá»™i hÆ¡n Pages Router**.

---
[<< BÃ€I 04](./04.md) | [BÃ€I 05 >>](./05.md)