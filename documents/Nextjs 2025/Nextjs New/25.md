## 🧭 Error Handling trong Next.js

### 🎯 Mục tiêu

* Hiểu cách Next.js **quản lý lỗi trong App Router**.
* Biết cách tạo **error boundaries** cho từng route, layout hoặc toàn app.
* Cải thiện trải nghiệm người dùng khi xảy ra lỗi.

---

## 🧱 1️⃣ Cơ chế cơ bản

* Trong App Router, bạn có thể tạo **file `error.tsx`** trong **bất kỳ thư mục route nào**.
* Khi route con hoặc layout đó gặp lỗi, **Next.js tự động render `error.tsx`** thay vì crash toàn bộ app.

```
app/
├── dashboard/
│   ├── error.tsx
│   ├── layout.tsx
│   └── page.tsx
```

* `/dashboard/error.tsx` sẽ được render nếu `page.tsx` hoặc component con trong dashboard throw error.

---

## 🧩 2️⃣ Ví dụ Error Component

```tsx
// app/dashboard/error.tsx
"use client";

import { useEffect } from "react";

interface ErrorProps {
  error: Error;
  reset: () => void;
}

export default function DashboardError({ error, reset }: ErrorProps) {
  useEffect(() => {
    console.error("Dashboard error:", error);
  }, [error]);

  return (
    <div style={{ padding: "2rem", color: "red" }}>
      <h2>Something went wrong in Dashboard!</h2>
      <p>{error.message}</p>
      <button onClick={() => reset()}>Try Again</button>
    </div>
  );
}
```

* `reset()` sẽ **reset error boundary** và thử render lại page/layout.
* Chỉ **component lỗi + layout lỗi** bị thay thế, không ảnh hưởng đến các layout khác.

---

## 🧱 3️⃣ Nested Error Handling

```
app/
├── dashboard/
│   ├── error.tsx
│   └── analytics/
│       └── error.tsx
```

* Lỗi trong `/dashboard/analytics` sẽ render **analytics/error.tsx**, nếu không có → fallback lên **dashboard/error.tsx**.
* Lỗi toàn cục → render **root app/error.tsx**.

---

## 💡 4️⃣ Nguyên tắc

* Tạo **error.tsx** ở mỗi layer nếu muốn handle riêng
* **Root error.tsx** là fallback cuối cùng
* Kết hợp với **loading.tsx** cho UX mượt mà


---
[<< BÀI 24](./24.md) | [BÀI 26 >>](./26.md)