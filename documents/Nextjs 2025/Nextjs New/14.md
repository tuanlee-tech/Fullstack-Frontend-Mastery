
# 🧭 Layouts trong Next.js

### 🎯 Mục tiêu

* Hiểu **layout là gì** và **vì sao nó quan trọng** trong App Router.
* Biết cách tạo `layout.tsx` và cách nó **bọc các trang con**.
* Nắm được **luồng render layout → page** trong Next.js.

---

## 🧱 1️⃣ Layout là gì?

> Trong App Router, **layout.tsx** là file định nghĩa *UI khung (frame)* bao quanh các trang con (`page.tsx`).

* Nó giúp **tái sử dụng cấu trúc giao diện** (menu, header, footer...).
* Nó có thể **lồng nhau** (nested layouts).
* Và đặc biệt: **layout không bị unmount** khi chuyển giữa các trang con.

---

### 🧩 Ví dụ cơ bản

Cấu trúc thư mục:

```
app/
├── layout.tsx
├── page.tsx
└── about/
    └── page.tsx
```

---

📄 **app/layout.tsx**

```tsx
// Đây là Root Layout — bao quanh toàn bộ ứng dụng
export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body
        style={{
          fontFamily: "sans-serif",
          padding: "2rem",
          background: "#f9fafb",
        }}
      >
        <header
          style={{
            borderBottom: "1px solid #ccc",
            paddingBottom: "1rem",
            marginBottom: "1rem",
          }}
        >
          <h1>🌐 My Website</h1>
          <nav style={{ display: "flex", gap: "1rem" }}>
            <a href="/">Home</a>
            <a href="/about">About</a>
          </nav>
        </header>
        {children}
      </body>
    </html>
  );
}
```

---

📄 **app/page.tsx**

```tsx
export default function HomePage() {
  return (
    <div>
      <h2>🏠 Home Page</h2>
      <p>Welcome to the homepage of our Next.js site.</p>
    </div>
  );
}
```

---

📄 **app/about/page.tsx**

```tsx
export default function AboutPage() {
  return (
    <div>
      <h2>📘 About Page</h2>
      <p>This site is built with Next.js App Router.</p>
    </div>
  );
}
```

---

## ⚙️ 2️⃣ Khi render, Next.js làm gì?

Khi bạn truy cập `/about`, Next.js sẽ:

1. Render `app/layout.tsx` → Root Layout
2. Render `app/about/page.tsx` → Page con
3. Gắn `children` của layout = nội dung trang con.

➡ Kết quả HTML:

```html
<html>
  <body>
    <header>🌐 My Website ...</header>
    <h2>📘 About Page</h2>
    <p>This site is built with Next.js App Router.</p>
  </body>
</html>
```

---

## 🧠 3️⃣ Lợi ích của Layout

✅ Dễ tái sử dụng UI (menu, header, sidebar...)
✅ Không bị reload khi chuyển trang
✅ Có thể lồng layout nhiều tầng (ví dụ layout riêng cho `/dashboard`)
✅ Giúp quản lý state & trải nghiệm người dùng tốt hơn

---

## 🧩 4️⃣ So sánh layout và page

| Thành phần   | Vai trò                  | Render khi nào                                  |
| ------------ | ------------------------ | ----------------------------------------------- |
| `layout.tsx` | Khung UI bao quanh route | Render **một lần**, giữ nguyên khi chuyển trang |
| `page.tsx`   | Nội dung riêng của route | Render lại khi route thay đổi                   |

---

## 💬 5️⃣ Bài tập nhỏ

> Hãy tạo cấu trúc sau:

```
app/
├── layout.tsx (Header + Footer)
├── page.tsx (Home)
└── about/
    └── page.tsx (About)
```

Khi chuyển giữa `/` và `/about`:

* Header/Footer **không reload**
* Chỉ phần nội dung thay đổi


---

# 🌐 Ví dụ hoàn chỉnh: Layout cơ bản

### 🧭 Cấu trúc thư mục

```
app/
├── layout.tsx        // Root Layout
├── globals.css       // CSS chung (nếu có)
├── page.tsx          // Home page
└── about/
    └── page.tsx      // About page
```

---

### 📄 `app/layout.tsx`

```tsx
import Link from "next/link";
import "./globals.css"; // optional

export const metadata = {
  title: "Next.js Layout Demo",
  description: "Understanding Root Layout in Next.js App Router",
};

// Root Layout: bọc toàn bộ ứng dụng
export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className="font-sans bg-gray-50 text-gray-900">
        <header className="border-b border-gray-300 p-4 bg-white shadow-sm sticky top-0 z-50">
          <h1 className="text-2xl font-bold mb-2">🌐 My Website</h1>
          <nav className="flex gap-4">
            <Link href="/" className="text-blue-600 hover:underline">
              Home
            </Link>
            <Link href="/about" className="text-blue-600 hover:underline">
              About
            </Link>
          </nav>
        </header>

        <main className="p-6 min-h-[70vh]">{children}</main>

        <footer className="border-t border-gray-300 p-4 text-center text-sm text-gray-600 bg-white">
          © {new Date().getFullYear()} My Website. All rights reserved.
        </footer>
      </body>
    </html>
  );
}
```

---

### 📄 `app/page.tsx` (Home)

```tsx
export default function HomePage() {
  return (
    <section>
      <h2 className="text-xl font-semibold mb-2">🏠 Home Page</h2>
      <p>
        Welcome to the homepage! This layout stays visible even when you navigate
        between pages.
      </p>
    </section>
  );
}
```

---

### 📄 `app/about/page.tsx`

```tsx
export default function AboutPage() {
  return (
    <section>
      <h2 className="text-xl font-semibold mb-2">📘 About Page</h2>
      <p>
        This page is rendered inside the same Root Layout. Notice the header and
        footer do not reload.
      </p>
    </section>
  );
}
```

---

### ✅ Kết quả khi chạy

* `/` hiển thị **Home Page**
* `/about` hiển thị **About Page**
* Header/Footer **giữ nguyên** (không reload lại)
* Navigation mượt mà nhờ **App Router** và **hydration** tự động.

---

### 🧠 Giải thích thêm về Hydration trong ví dụ này:

* Khi load lần đầu, Next.js render layout + page **ở server** (SSR).
* Sau đó, JS client sẽ **hydrate** lại phần React component tương ứng.
* Khi bạn click `<Link>`, Next.js chỉ **render phần nội dung thay đổi (children)** → layout không unmount.

---
[<< BÀI 13](./13.md) | [BÀI 15 >>](./15.md)