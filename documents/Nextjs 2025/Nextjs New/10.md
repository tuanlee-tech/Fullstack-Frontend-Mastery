## ğŸ§­ Not Found Page trong Next.js

### ğŸ¯ Má»¥c tiÃªu

* Hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a `not-found.tsx`
* PhÃ¢n biá»‡t **not-found toÃ n cá»¥c (global)** vÃ  **not-found cá»¥c bá»™ (nested)**
* Biáº¿t cÃ¡ch sá»­ dá»¥ng hÃ m `notFound()` Ä‘á»ƒ trigger 404 tÃ¹y Ã½ trong server component.

---

## ğŸ§± 1ï¸âƒ£ KhÃ¡i niá»‡m cÆ¡ báº£n

Trong App Router, báº¡n chá»‰ cáº§n táº¡o file Ä‘áº·c biá»‡t cÃ³ tÃªn:

```
app/not-found.tsx
```

hoáº·c trong báº¥t ká»³ thÆ° má»¥c route nÃ o, vÃ­ dá»¥:

```
app/dashboard/not-found.tsx
```

Next.js sáº½ tá»± Ä‘á»™ng render trang nÃ y khi:

* NgÆ°á»i dÃ¹ng truy cáº­p route khÃ´ng tá»“n táº¡i.
* Hoáº·c báº¡n **chá»§ Ä‘á»™ng gá»i** `notFound()` trong code (vÃ­ dá»¥ khi khÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u).

---

## ğŸ“„ 2ï¸âƒ£ Global Not Found Page

### ğŸ”¹ `app/not-found.tsx`

```tsx
// app/not-found.tsx
export default function NotFound() {
  return (
    <div
      style={{
        padding: "2rem",
        textAlign: "center",
        color: "#555",
      }}
    >
      <h1>ğŸš« 404 â€” Page Not Found</h1>
      <p>The page you are looking for doesnâ€™t exist or has been moved.</p>
      <a
        href="/"
        style={{
          marginTop: "1rem",
          display: "inline-block",
          textDecoration: "underline",
        }}
      >
        â† Go back to Home
      </a>
    </div>
  );
}
```

â¡ Khi ngÆ°á»i dÃ¹ng vÃ o `/abcxyz` (khÃ´ng cÃ³ route), Next.js sáº½ tá»± Ä‘á»™ng hiá»ƒn thá»‹ file nÃ y.

---

## ğŸ“‚ 3ï¸âƒ£ Nested Not Found Page

Báº¡n cÃ³ thá»ƒ táº¡o file `not-found.tsx` trong má»™t route cá»¥ thá»ƒ, vÃ­ dá»¥:

```
app/dashboard/
â”œâ”€â”€ layout.tsx
â”œâ”€â”€ page.tsx
â””â”€â”€ not-found.tsx
```

### ğŸ”¹ `app/dashboard/not-found.tsx`

```tsx
export default function DashboardNotFound() {
  return (
    <div>
      <h2>âŒ Dashboard Section Not Found</h2>
      <p>The requested dashboard page does not exist.</p>
    </div>
  );
}
```

â¡ LÃºc nÃ y, `/dashboard/invalid-page` sáº½ hiá»ƒn thá»‹ trang nÃ y **thay vÃ¬ global 404.**

---

## âš™ï¸ 4ï¸âƒ£ Trigger 404 thá»§ cÃ´ng báº±ng `notFound()`

Báº¡n cÃ³ thá»ƒ import vÃ  gá»i hÃ m `notFound()` trong **server component** khi khÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u.

```tsx
// app/products/[id]/page.tsx
import { notFound } from "next/navigation";

export default async function ProductPage({
  params,
}: {
  params: { id: string };
}) {
  const res = await fetch(`https://api.example.com/products/${params.id}`);

  if (!res.ok) {
    notFound(); // ğŸ”¥ Gá»i 404 thá»§ cÃ´ng
  }

  const product = await res.json();

  return (
    <div>
      <h1>{product.name}</h1>
      <p>Price: ${product.price}</p>
    </div>
  );
}
```

---

## ğŸ§© 5ï¸âƒ£ CÆ¡ cháº¿ render 404 trong App Router

Thá»© tá»± Æ°u tiÃªn cá»§a Next.js khi render `not-found`:

1. Náº¿u route cÃ³ file `not-found.tsx` cá»¥c bá»™ â†’ dÃ¹ng file Ä‘Ã³.
2. Náº¿u khÃ´ng, tÃ¬m file `not-found.tsx` á»Ÿ cáº¥p cao hÆ¡n (layout cha).
3. Náº¿u khÃ´ng cÃ³ â†’ fallback sang `app/not-found.tsx` (global).
4. Náº¿u váº«n khÃ´ng cÃ³ â†’ render máº·c Ä‘á»‹nh trang 404 máº·c Ä‘á»‹nh cá»§a Next.js.

---

## ğŸ’¬ 6ï¸âƒ£ BÃ i táº­p nhá»

> Táº¡o cáº¥u trÃºc `/blog/[slug]`:
>
> * Náº¿u slug khÃ´ng tá»“n táº¡i trong danh sÃ¡ch giáº£ láº­p (`["nextjs", "react", "tailwind"]`), gá»i `notFound()`.
> * ThÃªm `not-found.tsx` riÃªng cho `/blog` hiá»ƒn thá»‹ â€œBÃ i viáº¿t khÃ´ng tá»“n táº¡iâ€.

---
DÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng dáº«n bÃ i táº­p â€” táº¡o cáº¥u trÃºc `/blog/[slug]` trong **Next.js App Router** kÃ¨m xá»­ lÃ½ `notFound()` vÃ  trang `not-found.tsx` riÃªng cho `/blog`.

---

## ğŸ§© **Má»¥c tiÃªu**

* DÃ¹ng **Dynamic Route** `/blog/[slug]`
* Kiá»ƒm tra slug há»£p lá»‡ trong danh sÃ¡ch giáº£ láº­p
* Náº¿u **khÃ´ng há»£p lá»‡ â†’ gá»i `notFound()`**
* Táº¡o file `app/blog/not-found.tsx` Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o riÃªng cho Blog

---

## ğŸ“‚ **Cáº¥u trÃºc thÆ° má»¥c**

```
app/
 â”œâ”€ layout.tsx
 â”œâ”€ page.tsx
 â””â”€ blog/
     â”œâ”€ [slug]/
     â”‚   â””â”€ page.tsx
     â””â”€ not-found.tsx
```

---

## ğŸ“˜ **BÆ°á»›c 1. Táº¡o danh sÃ¡ch bÃ i viáº¿t giáº£ láº­p**

File: `app/blog/[slug]/page.tsx`

```tsx
import { notFound } from "next/navigation";

const fakePosts = ["nextjs", "react", "tailwind"];

interface BlogPageProps {
  params: { slug: string };
}

export default function BlogPage({ params }: BlogPageProps) {
  const { slug } = params;

  // âœ… Kiá»ƒm tra xem slug cÃ³ há»£p lá»‡ khÃ´ng
  if (!fakePosts.includes(slug)) {
    notFound(); // Gá»i trang not-found riÃªng
  }

  return (
    <main className="p-6">
      <h1 className="text-2xl font-bold capitalize">{slug} bÃ i viáº¿t</h1>
      <p className="mt-2 text-gray-700">
        ÄÃ¢y lÃ  ná»™i dung mÃ´ phá»ng cho bÃ i viáº¿t <strong>{slug}</strong>.
      </p>
    </main>
  );
}
```

---

## ğŸ“˜ **BÆ°á»›c 2. Táº¡o trang not-found riÃªng cho Blog**

File: `app/blog/not-found.tsx`

```tsx
export default function BlogNotFound() {
  return (
    <main className="flex flex-col items-center justify-center min-h-screen text-center">
      <h1 className="text-3xl font-bold mb-4 text-red-500">
        BÃ i viáº¿t khÃ´ng tá»“n táº¡i ğŸ«¤
      </h1>
      <p className="text-gray-600">
        CÃ³ váº» nhÆ° Ä‘Æ°á»ng dáº«n báº¡n nháº­p khÃ´ng Ä‘Ãºng hoáº·c bÃ i viáº¿t Ä‘Ã£ bá»‹ xÃ³a.
      </p>
    </main>
  );
}
```

---

## âœ… **Káº¿t quáº£ mong Ä‘á»£i**

| Truy cáº­p         | Káº¿t quáº£                                    |
| ---------------- | ------------------------------------------ |
| `/blog/nextjs`   | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t                 |
| `/blog/react`    | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t                 |
| `/blog/tailwind` | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t                 |
| `/blog/unknown`  | Hiá»ƒn thá»‹ trang `BÃ i viáº¿t khÃ´ng tá»“n táº¡i ğŸ«¤` |

---

## ğŸ’¡ **Gá»£i Ã½ nÃ¢ng cao**

* CÃ³ thá»ƒ thay danh sÃ¡ch giáº£ láº­p báº±ng **fetch API / database** sau nÃ y.
* CÃ³ thá»ƒ táº¡o thÃªm file `generateStaticParams()` Ä‘á»ƒ pre-render 3 bÃ i viáº¿t há»£p lá»‡.

VÃ­ dá»¥:

```tsx
export async function generateStaticParams() {
  return fakePosts.map((slug) => ({ slug }));
}
```

Giá» ta sáº½ **nÃ¢ng cáº¥p module `/blog` hoÃ n chá»‰nh** vá»›i Ä‘áº§y Ä‘á»§ cÃ¡c tÃ­nh nÄƒng Next.js App Router **má»©c production**:
âœ… Dynamic Route
âœ… Static Generation (`generateStaticParams`)
âœ… Loading state (`loading.tsx`)
âœ… Not-found riÃªng
âœ… Demo fetch API giáº£ láº­p
âœ… Metadata Ä‘á»™ng (`generateMetadata`)

---

## ğŸ“‚ **Cáº¥u trÃºc thÆ° má»¥c Ä‘áº§y Ä‘á»§**

```
app/
 â”œâ”€ layout.tsx
 â”œâ”€ page.tsx
 â””â”€ blog/
     â”œâ”€ [slug]/
     â”‚   â”œâ”€ page.tsx
     â”‚   â””â”€ loading.tsx
     â”œâ”€ not-found.tsx
     â””â”€ data.ts
```

---

## ğŸ§± **BÆ°á»›c 1. Táº¡o data giáº£ láº­p**

ğŸ“„ `app/blog/data.ts`

```ts
export const fakePosts = [
  {
    slug: "nextjs",
    title: "LÃ m chá»§ Next.js App Router",
    content: "App Router giÃºp ta xÃ¢y dá»±ng á»©ng dá»¥ng nhanh vÃ  linh hoáº¡t hÆ¡n...",
  },
  {
    slug: "react",
    title: "Hiá»ƒu sÃ¢u React Rendering",
    content: "React Rendering lÃ  cá»‘t lÃµi cá»§a hiá»‡u nÄƒng trong UI hiá»‡n Ä‘áº¡i...",
  },
  {
    slug: "tailwind",
    title: "Thiáº¿t káº¿ Ä‘áº¹p nhanh vá»›i Tailwind CSS",
    content: "Tailwind giÃºp báº¡n viáº¿t CSS theo component, tá»‘c Ä‘á»™ vÃ  linh hoáº¡t.",
  },
];
```

---

## ğŸ§­ **BÆ°á»›c 2. Táº¡o Dynamic Page `/blog/[slug]/page.tsx`**

ğŸ“„ `app/blog/[slug]/page.tsx`

```tsx
import { notFound } from "next/navigation";
import { fakePosts } from "../data";

interface BlogPageProps {
  params: { slug: string };
}

// âœ… Generate Static Params
export async function generateStaticParams() {
  return fakePosts.map((post) => ({ slug: post.slug }));
}

// âœ… Generate Metadata (SEO) â€” Há»c á»Ÿ bÃ i sau
export async function generateMetadata({ params }: BlogPageProps) {
  const post = fakePosts.find((p) => p.slug === params.slug);
  if (!post) {
    return {
      title: "BÃ i viáº¿t khÃ´ng tá»“n táº¡i | Blog",
      description: "KhÃ´ng tÃ¬m tháº¥y bÃ i viáº¿t nÃ y.",
    };
  }

  return {
    title: `${post.title} | Blog`,
    description: post.content.slice(0, 100),
  };
}

// âœ… Page Component
export default async function BlogPage({ params }: BlogPageProps) {
  const { slug } = params;
  const post = fakePosts.find((p) => p.slug === slug);

  // Náº¿u khÃ´ng cÃ³ slug -> 404
  if (!post) notFound();

  // Giáº£ láº­p fetch cháº­m
  await new Promise((r) => setTimeout(r, 1200));

  return (
    <article className="prose mx-auto p-8">
      <h1 className="text-3xl font-bold">{post.title}</h1>
      <p className="text-gray-700 mt-4">{post.content}</p>
    </article>
  );
}
```

---

## ğŸ• **BÆ°á»›c 3. Loading UI khi fetch**

ğŸ“„ `app/blog/[slug]/loading.tsx`

```tsx
export default function BlogLoading() {
  return (
    <div className="flex items-center justify-center min-h-[50vh]">
      <div className="animate-pulse text-gray-500">
        Äang táº£i bÃ i viáº¿t...
      </div>
    </div>
  );
}
```

---

## ğŸš« **BÆ°á»›c 4. Trang not-found riÃªng**

ğŸ“„ `app/blog/not-found.tsx`

```tsx
export default function BlogNotFound() {
  return (
    <main className="flex flex-col items-center justify-center min-h-[50vh] text-center">
      <h1 className="text-3xl font-bold mb-3 text-red-500">
        BÃ i viáº¿t khÃ´ng tá»“n táº¡i ğŸ«¤
      </h1>
      <p className="text-gray-600">
        CÃ³ thá»ƒ bÃ i viáº¿t Ä‘Ã£ bá»‹ xÃ³a hoáº·c Ä‘Æ°á»ng dáº«n khÃ´ng Ä‘Ãºng.
      </p>
    </main>
  );
}
```

---

## âš™ï¸ **CÃ¡ch hoáº¡t Ä‘á»™ng**

| TÃ¬nh huá»‘ng       | Káº¿t quáº£                                                    |
| ---------------- | ---------------------------------------------------------- |
| `/blog/nextjs`   | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t Next.js                         |
| `/blog/react`    | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t React                           |
| `/blog/tailwind` | Hiá»ƒn thá»‹ ná»™i dung bÃ i viáº¿t Tailwind                        |
| `/blog/unknown`  | Gá»i `notFound()` â†’ Hiá»ƒn thá»‹ trang â€œBÃ i viáº¿t khÃ´ng tá»“n táº¡iâ€ |
| Khi fetch cháº­m   | Hiá»ƒn thá»‹ `loading.tsx` trong lÃºc chá»                       |

---

## ğŸ§  **Hiá»ƒu sÃ¢u hÆ¡n**

| ThÃ nh pháº§n               | Chá»©c nÄƒng                                                                      |
| ------------------------ | ------------------------------------------------------------------------------ |
| `generateStaticParams()` | GiÃºp Next.js build sáºµn 3 trang `/blog/nextjs`, `/blog/react`, `/blog/tailwind` |
| `generateMetadata()`     | Táº¡o tiÃªu Ä‘á» SEO riÃªng cho tá»«ng bÃ i                                             |
| `loading.tsx`            | Render trong khi `page.tsx` Ä‘ang fetch dá»¯ liá»‡u                                 |
| `not-found.tsx`          | Trang lá»—i 404 riÃªng cho nhÃ¡nh `/blog`                                          |

---

## ğŸ’¡ **BÃ i táº­p nÃ¢ng cao**

1. ThÃªm `/blog/page.tsx` hiá»ƒn thá»‹ danh sÃ¡ch bÃ i viáº¿t.
2. Chuyá»ƒn `fakePosts` thÃ nh fetch API tá»« JSON placeholder.
3. DÃ¹ng **Suspense + ErrorBoundary** Ä‘á»ƒ quáº£n lÃ½ lá»—i network.
4. Ãp dá»¥ng **revalidate** vÃ  **cache: "force-cache"** cho dá»¯ liá»‡u tháº­t.

---

[<< BÃ€I 09](./09.md) | [BÃ€I 11 >>](./11.md)