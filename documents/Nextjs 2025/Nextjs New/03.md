# üß© 3. C·∫§U TR√öC D·ª∞ √ÅN NEXT.JS (APP ROUTER)

## üéØ M·ª•c ti√™u

Sau b√†i n√†y, b·∫°n s·∫Ω:

* Hi·ªÉu **to√†n b·ªô c·∫•u tr√∫c th∆∞ m·ª•c chu·∫©n c·ªßa App Router**
* Ph√¢n bi·ªát gi·ªØa **Server Component**, **Client Component**, **Route Handler**, **Middleware**, **Metadata**, **Static Assets**
* Bi·∫øt **m·ªói file trong `app/` c√≥ nhi·ªám v·ª• g√¨**
* Hi·ªÉu **v√¨ sao App Router kh√°c ho√†n to√†n Pages Router c≈©**

---

## ‚öôÔ∏è 1Ô∏è‚É£ C·∫•u tr√∫c t·ªïng quan d·ª± √°n Next.js

Khi b·∫°n t·∫°o project b·∫±ng:

```bash
npx create-next-app@latest my-next-app
```

Th∆∞ m·ª•c m·∫∑c ƒë·ªãnh s·∫Ω nh∆∞ sau üëá

```
my-next-app/
‚îú‚îÄ app/
‚îÇ   ‚îú‚îÄ layout.tsx
‚îÇ   ‚îú‚îÄ page.tsx
‚îÇ   ‚îú‚îÄ globals.css
‚îÇ   ‚îú‚îÄ favicon.ico
‚îÇ   ‚îî‚îÄ (c√°c route con, v√≠ d·ª• blog/, dashboard/, api/‚Ä¶)
‚îÇ
‚îú‚îÄ public/
‚îÇ   ‚îú‚îÄ images/
‚îÇ   ‚îî‚îÄ icons/
‚îÇ
‚îú‚îÄ components/
‚îÇ   ‚îú‚îÄ ui/
‚îÇ   ‚îú‚îÄ layout/
‚îÇ   ‚îî‚îÄ ...
‚îÇ
‚îú‚îÄ lib/
‚îÇ   ‚îî‚îÄ utils.ts
‚îÇ
‚îú‚îÄ styles/
‚îÇ   ‚îî‚îÄ globals.css
‚îÇ
‚îú‚îÄ middleware.ts
‚îú‚îÄ next.config.js
‚îú‚îÄ tailwind.config.ts
‚îî‚îÄ package.json
```

---

## üì¶ 2Ô∏è‚É£ Gi·∫£i th√≠ch t·ª´ng ph·∫ßn chi ti·∫øt

| Th∆∞ m·ª•c / File     | M√¥ t·∫£                                                          | Render ·ªü ƒë√¢u       |
| ------------------ | -------------------------------------------------------------- | ------------------ |
| **app/**           | N∆°i ch·ª©a to√†n b·ªô route (App Router)                            | Server             |
| **layout.tsx**     | Layout g·ªëc ‚Äî bao quanh t·∫•t c·∫£ c√°c trang con                    | Server             |
| **page.tsx**       | Trang ch√≠nh t∆∞∆°ng ·ª©ng v·ªõi 1 route                              | Server             |
| **loading.tsx**    | Component hi·ªÉn th·ªã khi ƒëang loading (async data, streaming...) | Client             |
| **error.tsx**      | Component hi·ªÉn th·ªã khi c√≥ l·ªói trong route                      | Client             |
| **template.tsx**   | Cho ph√©p re-render l·∫°i layout khi route thay ƒë·ªïi               | Server             |
| **not-found.tsx**  | Trang 404 c·ªßa ri√™ng route ƒë√≥                                   | Server             |
| **route.ts**       | T·∫°o API Route trong App Router                                 | Server             |
| **components/**    | Ch·ª©a c√°c UI component t√°i s·ª≠ d·ª•ng                              | Server ho·∫∑c Client |
| **lib/**           | H√†m ti·ªán √≠ch, logic x·ª≠ l√Ω, k·∫øt n·ªëi DB                          | Server             |
| **middleware.ts**  | Ch·∫°y tr∆∞·ªõc m·ªói request ƒë·ªÉ x·ª≠ l√Ω b·∫£o m·∫≠t, auth, redirect...     | Edge (Server)      |
| **public/**        | Ch·ª©a file tƒ©nh (·∫£nh, font, favicon, JSON...)                   | Public             |
| **styles/**        | CSS to√†n c·ª•c ho·∫∑c module CSS                                   | Client             |
| **next.config.js** | File c·∫•u h√¨nh Next.js                                          | Build-time         |
| **package.json**   | Danh s√°ch dependencies, scripts                                | ‚Äî                  |

---

## üß≠ 3Ô∏è‚É£ C·∫•u tr√∫c `app/` chi ti·∫øt

```
app/
‚îú‚îÄ layout.tsx
‚îú‚îÄ page.tsx
‚îú‚îÄ dashboard/
‚îÇ   ‚îú‚îÄ layout.tsx
‚îÇ   ‚îú‚îÄ page.tsx
‚îÇ   ‚îú‚îÄ analytics/
‚îÇ   ‚îÇ   ‚îî‚îÄ page.tsx
‚îÇ   ‚îî‚îÄ users/
‚îÇ       ‚îú‚îÄ [id]/
‚îÇ       ‚îÇ   ‚îî‚îÄ page.tsx
‚îÇ       ‚îî‚îÄ page.tsx
‚îî‚îÄ api/
    ‚îú‚îÄ hello/
    ‚îÇ   ‚îî‚îÄ route.ts
    ‚îî‚îÄ posts/
        ‚îî‚îÄ [id]/
            ‚îî‚îÄ route.ts
```

### Gi·∫£i th√≠ch:

| Lo·∫°i                 | V√≠ d·ª•                           | M√¥ t·∫£                           |
| -------------------- | ------------------------------- | ------------------------------- |
| **Route Segment**    | `/dashboard` ‚Üí `app/dashboard/` | M·ªôt ph·∫ßn c·ªßa URL                |
| **Dynamic Route**    | `/dashboard/users/[id]`         | `[id]` l√† bi·∫øn ƒë·ªông             |
| **Nested Route**     | `/dashboard/analytics`          | L·ªìng nhi·ªÅu c·∫•p                  |
| **API Route**        | `/api/posts/[id]`               | T·∫°o endpoint x·ª≠ l√Ω d·ªØ li·ªáu      |
| **Layout l·ªìng nhau** | `dashboard/layout.tsx`          | Layout ri√™ng cho t·ª´ng route con |

---

## üß© 4Ô∏è‚É£ M·ªëi quan h·ªá gi·ªØa c√°c file

```
app/
‚îî‚îÄ‚îÄ dashboard/
    ‚îú‚îÄ‚îÄ layout.tsx   ‚Üí Bao quanh c√°c page b√™n trong
    ‚îú‚îÄ‚îÄ page.tsx     ‚Üí Giao di·ªán ch√≠nh c·ªßa /dashboard
    ‚îú‚îÄ‚îÄ loading.tsx  ‚Üí Loading UI khi page ƒëang fetch
    ‚îú‚îÄ‚îÄ error.tsx    ‚Üí UI khi c√≥ l·ªói
    ‚îú‚îÄ‚îÄ template.tsx ‚Üí Re-render layout khi route thay ƒë·ªïi
    ‚îî‚îÄ‚îÄ users/
        ‚îî‚îÄ‚îÄ page.tsx
```

> üí° T·∫•t c·∫£ c√°c file n√†y ƒë·ªÅu ƒë∆∞·ª£c Next.js t·ª± ƒë·ªông hi·ªÉu **theo vai tr√≤ ƒë·∫∑c bi·ªát**,
> b·∫°n **kh√¥ng c·∫ßn import ho·∫∑c config th·ªß c√¥ng nh∆∞ React Router**.

---

## ‚öôÔ∏è 5Ô∏è‚É£ So s√°nh nhanh App Router vs Pages Router

| T√≠nh nƒÉng                     | App Router (m·ªõi)                 | Pages Router (c≈©)                      |
| ----------------------------- | -------------------------------- | -------------------------------------- |
| Render m·∫∑c ƒë·ªãnh               | Server Component                 | Client Component                       |
| Routing                       | File-based, h·ªó tr·ª£ nested routes | File-based, kh√¥ng nested               |
| Layout                        | C√≥ (h·ªó tr·ª£ nhi·ªÅu c·∫•p)            | Kh√¥ng c√≥ layout hierarchy              |
| API Routes                    | `route.ts`                       | `pages/api/`                           |
| Data Fetching                 | Server-first (`async component`) | `getServerSideProps`, `getStaticProps` |
| Streaming / Suspense          | ‚úÖ C√≥                             | ‚ùå Kh√¥ng                                |
| React Server Components       | ‚úÖ C√≥                             | ‚ùå Kh√¥ng                                |
| Recommended cho phi√™n b·∫£n 14+ | ‚úÖ C√≥                             | ‚ùå Deprecated                           |

---

## ‚ö° 6Ô∏è‚É£ Demo v√≠ d·ª• nh·ªè

### **app/page.tsx**

```tsx
export default function Page() {
  return (
    <main className="flex flex-col items-center justify-center min-h-screen">
      <h1 className="text-3xl font-bold text-blue-600">
        Welcome to Next.js App Router
      </h1>
    </main>
  );
}
```

### **app/dashboard/page.tsx**

```tsx
export default function DashboardPage() {
  return <h2 className="text-xl">This is the Dashboard Page</h2>;
}
```

‚û° Truy c·∫≠p `/` ‚Üí hi·ªÉn th·ªã trang ch·ªß
‚û° Truy c·∫≠p `/dashboard` ‚Üí hi·ªÉn th·ªã trang Dashboard
Kh√¥ng c·∫ßn c·∫•u h√¨nh router th·ªß c√¥ng ‚Äî Next.js t·ª± ƒë·ªông √°nh x·∫° (map) URL ‚Üî file.

---

## üîç 7Ô∏è‚É£ Best Practices v·ªÅ c·∫•u tr√∫c th∆∞ m·ª•c

| Lo·∫°i code                      | N√™n ƒë·∫∑t ·ªü ƒë√¢u          |
| ------------------------------ | ---------------------- |
| UI component (button, card...) | `components/ui/`       |
| Layout, navigation             | `components/layout/`   |
| Server utilities, DB queries   | `lib/`                 |
| Type definitions               | `types/`               |
| Config (SEO, site info...)     | `config/`              |
| API routes                     | `app/api/.../route.ts` |
| Styles                         | `styles/`              |
| Static assets                  | `public/`              |

---

## ‚úÖ T√≥m t·∫Øt

> Next.js App Router gi√∫p t·ªï ch·ª©c d·ª± √°n **r√µ r√†ng, module ho√°, c√≥ t√≠nh m·ªü r·ªông cao**.
> M·ªói th∆∞ m·ª•c trong `app/` ƒë·∫°i di·ªán cho m·ªôt route, v√† m·ªói lo·∫°i file (`layout`, `page`, `loading`, `error`, `route`) c√≥ nhi·ªám v·ª• r√µ r√†ng.


---
[<< B√ÄI 02](./02.md) | [B√ÄI 04 >>](./04.md)