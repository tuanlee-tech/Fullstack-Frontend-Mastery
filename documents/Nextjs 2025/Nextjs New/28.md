

## 🧭 Conditional Routes trong Next.js

### 🎯 Mục tiêu

* Hiểu cách **hiển thị hoặc ẩn route dựa trên điều kiện** (ví dụ: role, feature flag, trạng thái login).
* Không cần tạo nhiều file page riêng lẻ.
* Kết hợp **Server Components** hoặc **Client Components** để kiểm soát điều kiện.

---

## 🧱 1️⃣ Ví dụ cơ bản

Giả sử bạn có dashboard, nhưng **chỉ người admin mới xem được `/admin`**:

```tsx
// app/dashboard/admin/page.tsx
import { getCurrentUser } from "@/lib/session";

export default async function AdminPage() {
  const user = await getCurrentUser();

  if (!user?.isAdmin) {
    return <p>Bạn không có quyền truy cập trang này.</p>;
  }

  return (
    <div>
      <h1>Admin Dashboard</h1>
      <p>Chỉ admin mới xem được nội dung này.</p>
    </div>
  );
}
```

* **Server Component**: kiểm tra quyền trước khi render.
* **Client Component** cũng có thể dùng state để show/hide component.

---

## 🧩 2️⃣ Conditional navigation

Bạn có thể **ẩn link trong layout** nếu người dùng không đủ quyền:

```tsx
// app/dashboard/layout.tsx
import { getCurrentUser } from "@/lib/session";

export default async function DashboardLayout({ children }: { children: React.ReactNode }) {
  const user = await getCurrentUser();

  return (
    <div>
      <nav>
        <a href="/dashboard">Overview</a>
        {user?.isAdmin && <a href="/dashboard/admin">Admin</a>}
      </nav>
      <main>{children}</main>
    </div>
  );
}
```

* Link **Admin** chỉ xuất hiện khi điều kiện đúng.

---

## 💡 3️⃣ Lợi ích

* Không cần tạo nhiều route trùng lặp.
* Dễ kết hợp với **Role-Based Access Control (RBAC)**.
* Tăng tính bảo mật: route không hợp lệ sẽ không render.


---
[<< BÀI 27](./27.md) | [BÀI 29 >>](./29.md)