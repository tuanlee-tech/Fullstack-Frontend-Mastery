# ğŸš€ **LEVEL 2: INTERMEDIATE**

---

## ğŸ“Š **PROJECT 3: Habit & Accountability Tracker**

### ğŸ“– **Project Overview**
á»¨ng dá»¥ng theo dÃµi thÃ³i quen hÃ ng ngÃ y káº¿t há»£p yáº¿u tá»‘ trÃ¡ch nhiá»‡m xÃ£ há»™i (accountability) giÃºp ngÆ°á»i dÃ¹ng xÃ¢y dá»±ng thÃ³i quen tá»‘t bá»n vá»¯ng. KhÃ¡c biá»‡t: CÃ³ báº¡n bÃ¨ theo dÃµi vÃ  nháº¯c nhá»Ÿ nhau, khÃ´ng pháº£i tá»± Ä‘á»™ng lá»±c má»™t mÃ¬nh. Giáº£i quyáº¿t váº¥n Ä‘á»: "Táº¡i sao tÃ´i khÃ´ng thá»ƒ duy trÃ¬ thÃ³i quen tá»‘t?"

### ğŸ¯ **Target Users**
- NgÆ°á»i muá»‘n xÃ¢y dá»±ng thÃ³i quen tá»‘t (táº­p gym, Ä‘á»c sÃ¡ch, uá»‘ng nÆ°á»›c)
- NgÆ°á»i cáº§n Ä‘á»™ng lá»±c bÃªn ngoÃ i Ä‘á»ƒ kiÃªn trÃ¬
- NhÃ³m báº¡n muá»‘n cÃ¹ng phÃ¡t triá»ƒn (study group, gym buddies)
- NgÆ°á»i thÃ­ch gamification (streak, achievements)

### ğŸš€ **MVP - Week 1-2 (Core Features)**

**User Story 1: Create Habit**
```
AS A user
I WANT TO create a new habit to track
SO THAT I can build positive routines
```
**Acceptance Criteria:**
- âœ… Habit name (e.g., "Drink 2L water")
- âœ… Description (optional motivation)
- âœ… Icon selection (50+ icons: fitness, health, learning, productivity)
- âœ… Color theme (8 colors to choose)
- âœ… Frequency: Daily, Specific weekdays, Custom (every X days)
- âœ… Time of day (Morning, Afternoon, Evening, Anytime)
- âœ… Reminder notification (optional, set time)
- âœ… Target count per day (e.g., "3 times a day")

**User Story 2: Daily Check-in**
```
AS A user
I WANT TO mark habits as complete
SO THAT I track my progress
```
**Acceptance Criteria:**
- âœ… Today's habit list (only habits scheduled for today)
- âœ… Large checkbox (easy to tap on mobile)
- âœ… Satisfying animation on complete (confetti, checkmark)
- âœ… Sound effect (optional, toggle in settings)
- âœ… Increment count if multi-per-day habit
- âœ… Undo check-in (within 5 minutes)
- âœ… Add note to check-in (mood, observation)

**User Story 3: Streak Tracking**
```
AS A user
I WANT TO see my habit streaks
SO THAT I feel motivated to continue
```
**Acceptance Criteria:**
- âœ… Current streak count (days in a row)
- âœ… Longest streak (personal best)
- âœ… Streak badge (fire icon ğŸ”¥)
- âœ… Streak milestone notifications (7, 30, 100, 365 days)
- âœ… Streak warning (haven't checked in today)
- âœ… Streak freeze (1 free miss per month - premium feature idea)

**User Story 4: Calendar View**
```
AS A user
I WANT TO see my habit history in a calendar
SO THAT I visualize consistency
```
**Acceptance Criteria:**
- âœ… Heatmap calendar (GitHub-style)
- âœ… Color intensity based on completion rate
- âœ… Tap date to see details
- âœ… Month/Year view toggle
- âœ… Export calendar as image (share on social media)

**User Story 5: Basic Statistics**
```
AS A user
I WANT TO see my habit statistics
SO THAT I understand my progress
```
**Acceptance Criteria:**
- âœ… Completion rate (%) - This week, This month, All time
- âœ… Total check-ins
- âœ… Best day of week (highest completion)
- âœ… Worst day of week
- âœ… Line chart: Completion trend (last 30 days)
- âœ… Comparison: This month vs Last month

**Database Schema (MVP):**
```prisma
model User {
  id            String         @id @default(cuid())
  email         String         @unique
  name          String
  avatar        String?
  timezone      String         @default("UTC")
  habits        Habit[]
  habitLogs     HabitLog[]
  friendships   Friendship[]   @relation("UserFriendships")
  notifications Notification[]
  createdAt     DateTime       @default(now())
}

model Habit {
  id              String       @id @default(cuid())
  userId          String
  name            String
  description     String?
  icon            String
  color           String
  frequency       String       // "daily" | "weekly" | "custom"
  frequencyDays   Int[]        // [1,2,3,4,5] Mon-Fri
  targetCount     Int          @default(1)
  reminderTime    DateTime?
  isPublic        Boolean      @default(false)
  streak          Int          @default(0)
  longestStreak   Int          @default(0)
  totalCompletions Int         @default(0)
  logs            HabitLog[]
  archivedAt      DateTime?
  createdAt       DateTime     @default(now())
}

model HabitLog {
  id        String   @id @default(cuid())
  habitId   String
  userId    String
  date      DateTime
  completed Boolean  @default(true)
  count     Int      @default(1)
  note      String?
  mood      String?  // "great" | "good" | "okay" | "bad"
  createdAt DateTime @default(now())
  
  @@unique([habitId, userId, date])
}

model Friendship {
  id        String   @id @default(cuid())
  userId    String
  ```prisma
  friendId  String
  status    String   // "pending" | "accepted" | "blocked"
  createdAt DateTime @default(now())
  
  @@unique([userId, friendId])
}

model Notification {
  id        String   @id @default(cuid())
  userId    String
  type      String   // "reminder" | "friend_request" | "friend_completed" | "milestone"
  title     String
  body      String
  data      Json?
  read      Boolean  @default(false)
  createdAt DateTime @default(now())
}
```

---

### ğŸ“ˆ **Phase 2 - Week 3 (Social & Accountability Features)**

**Feature 1: Friend System**
```
AS A user
I WANT TO connect with friends
SO THAT we can support each other
```
**Acceptance Criteria:**
- âœ… Search users by email/username
- âœ… Send friend request
- âœ… Accept/Decline friend requests
- âœ… Friend list with avatars
- âœ… Remove friend
- âœ… Friend request notifications

**Feature 2: Accountability Partners**
```
AS A user
I WANT TO share specific habits with accountability partners
SO THAT they can keep me accountable
```
**Acceptance Criteria:**
- âœ… Invite friend to be accountability partner for a habit
- âœ… Partner accepts/declines invitation
- âœ… Partner sees your check-ins in real-time
- âœ… Partner can send encouragement ("Keep going!", "You got this!")
- âœ… Partner gets notification if you miss a day
- âœ… Remove partner from habit

**Feature 3: Social Feed**
```
AS A user
I WANT TO see my friends' activity
SO THAT I feel motivated and connected
```
**Acceptance Criteria:**
- âœ… Feed showing: Friend completed habit, Friend reached milestone, Friend created new habit
- âœ… Like/React to friend's achievements
- âœ… Comment on friend's progress
- âœ… Filter feed (All friends, Specific friend, Specific habit type)
- âœ… Refresh to load new activities
- âœ… Privacy: Only see habits marked as "public"

**Feature 4: Poke/Nudge Feature**
```
AS A user
I WANT TO remind my friend to complete their habit
SO THAT I help them stay on track
```
**Acceptance Criteria:**
- âœ… "Poke" button on friend's habit (if they haven't checked in today)
- âœ… Friend receives notification: "[Your name] is reminding you to [habit name]!"
- âœ… Can only poke once per day per habit
- âœ… Option to disable pokes in settings
- âœ… Friendly, encouraging tone (not nagging)

**Feature 5: Group Challenges**
```
AS A user
I WANT TO join challenges with friends
SO THAT we compete and motivate each other
```
**Acceptance Criteria:**
- âœ… Create challenge: Name, Habit, Duration (7 days, 30 days), Participants
- âœ… Invite friends to challenge
- âœ… Leaderboard (sorted by completion rate)
- âœ… Challenge chat (group discussion)
- âœ… Challenge completion certificate (share on social media)
- âœ… Recurring challenges (weekly, monthly)

**Feature 6: Public Habits & Community**
```
AS A user
I WANT TO make my habits public
SO THAT I can inspire others and find accountability in the community
```
**Acceptance Criteria:**
- âœ… Toggle habit visibility (Private, Friends, Public)
- âœ… Public habit feed (discover what others are tracking)
- âœ… Follow other users' public habits
- âœ… Habit templates from community (popular habits to add)
- âœ… Trending habits this week

---

### ğŸš€ **Phase 3 - Week 4 (Gamification & Advanced Features)**

**Feature 1: Achievement System**
```
AS A user
I WANT TO unlock achievements
SO THAT I feel rewarded for my progress
```
**Achievements to Implement:**
- âœ… **First Step**: Complete first habit check-in
- âœ… **Week Warrior**: 7-day streak
- âœ… **Month Master**: 30-day streak
- âœ… **Century Club**: 100-day streak
- âœ… **Year Champion**: 365-day streak
- âœ… **Early Bird**: Check in before 7 AM (10 times)
- âœ… **Night Owl**: Check in after 10 PM (10 times)
- âœ… **Perfect Week**: 100% completion for a week
- âœ… **Comeback Kid**: Resume habit after 7+ day break
- âœ… **Social Butterfly**: 10 friends added
- âœ… **Habit Collector**: 10 active habits
- âœ… **Motivator**: Poke friends 50 times
- âœ… **Challenger**: Complete 3 group challenges

**Acceptance Criteria:**
- âœ… Achievement notification (pop-up with animation)
- âœ… Achievement gallery (locked/unlocked states)
- âœ… Progress bars for incremental achievements
- âœ… Share achievement on social media
- âœ… Rarity indicator (Common, Rare, Epic, Legendary)

**Feature 2: Streak Freeze & Recovery**
```
AS A user
I WANT TO have flexibility when I miss a day
SO THAT I don't feel demotivated by one mistake
```
**Acceptance Criteria:**
- âœ… **Streak Freeze**: 2 per month (premium feature idea)
- âœ… Use freeze proactively (before missing) or reactively (after missing)
- âœ… Visual indicator (â„ï¸ icon on calendar)
- âœ… **Streak Repair**: Pay with points/coins to restore streak (within 24 hours)
- âœ… Earn freeze tokens by completing challenges

**Feature 3: Points & Rewards System**
```
AS A user
I WANT TO earn points for completing habits
SO THAT I can unlock rewards
```
**Point System:**
- âœ… +10 points per habit check-in
- âœ… +50 points per 7-day streak milestone
- âœ… +200 points per 30-day streak milestone
- âœ… +20 points for encouraging friends
- âœ… Bonus multiplier on weekends (2x points)

**Rewards to Unlock:**
- âœ… Custom themes (colors, icons)
- âœ… Avatar frames
- âœ… Streak freeze tokens
- âœ… Priority support (if premium)
- âœ… Exclusive badges
- âœ… Ad-free experience (if using ads)

**Feature 4: Advanced Analytics**
```
AS A user
I WANT TO see deep insights into my habits
SO THAT I optimize my routine
```
**Acceptance Criteria:**
- âœ… **Best Time Analysis**: When do you complete habits most? (morning/afternoon/evening)
- âœ… **Correlation Insights**: "You complete X more when you also complete Y"
- âœ… **Mood Tracking Integration**: How do habits affect your mood?
- âœ… **Streak Prediction**: AI prediction of streak continuation probability
- âœ… **Habit Stacking**: Recommend habits that pair well together
- âœ… **Energy Level Patterns**: Track when you have most motivation
- âœ… **Export Data**: CSV/JSON for personal analysis

**Feature 5: Smart Reminders**
```
AS A user
I WANT TO receive intelligent reminders
SO THAT I'm nudged at the right time
```
**Acceptance Criteria:**
- âœ… **Adaptive Timing**: Learn when you usually complete habits, remind 30 mins before
- âœ… **Streak Saver**: Extra reminder if you haven't checked in by 8 PM
- âœ… **Weather-Based**: "It's sunny! Perfect day for your outdoor run habit"
- âœ… **Location-Based**: Remind when you arrive at gym (geofencing)
- âœ… **Gentle Escalation**: First reminder gentle, second more urgent if still not done
- âœ… **Snooze**: Snooze reminder for 30 min, 1 hour, 2 hours

**Feature 6: Habit Templates & Categories**
```
AS A user
I WANT TO quickly start popular habits
SO THAT I don't have to configure from scratch
```
**Pre-built Templates:**

**Health & Fitness:**
- ğŸƒ Morning Run (30 min)
- ğŸ’§ Drink 2L Water (8 glasses)
- ğŸ§˜ Meditation (10 min)
- ğŸ’ª Workout (gym or home)
- ğŸ¥— Eat Healthy Meal
- ğŸ˜´ Sleep 8 Hours
- ğŸš¶ 10,000 Steps

**Productivity:**
- ğŸ“š Read 30 Pages
- âœï¸ Journal Entry
- ğŸ¯ Complete To-Do List
- ğŸ“§ Inbox Zero
- ğŸ§¹ Clean Workspace
- ğŸ“± No Phone 1st Hour After Waking

**Learning:**
- ğŸ—£ï¸ Practice English (30 min)
- ğŸ’» Code for 1 Hour
- ğŸ¨ Creative Practice
- ğŸµ Music Practice

**Mindfulness:**
- ğŸ™ Gratitude Journal (3 things)
- ğŸ“¿ Meditation
- ğŸŒ… Watch Sunrise/Sunset
- ğŸ“µ Digital Detox (1 hour)

**Social:**
- ğŸ“ Call Family
- ğŸ’Œ Message a Friend
- ğŸ¤ Random Act of Kindness

**Acceptance Criteria:**
- âœ… Template library categorized
- âœ… Preview template before adding
- âœ… Customize template (change name, icon, frequency)
- âœ… Add template to "My Habits" in 1 click
- âœ… Suggest templates based on user's existing habits

---

### ğŸ¨ **UI/UX Requirements**

**Design Principles:**
- **Motivational**: Bright colors, celebratory animations
- **Minimal Friction**: Check-in should take < 3 seconds
- **Visual Progress**: Heavy use of charts, streaks, heatmaps
- **Social Proof**: Show friends' achievements
- **Gamified**: Points, badges, levels

**Key Screens:**
1. **Today** - List of today's habits (primary screen, opens on launch)
2. **Calendar** - Heatmap view of habit history
3. **Habits** - Manage all habits (edit, archive, delete)
4. **Social** - Friends feed, challenges, leaderboards
5. **Profile** - Stats, achievements, settings
6. **Friends** - Friend list, requests, search
7. **Challenges** - Active challenges, create new, browse
8. **Achievements** - Gallery of unlocked achievements
9. **Analytics** - Deep insights, charts, trends

**Animations (Framer Motion):**
- âœ… Confetti explosion on habit completion
- âœ… Checkmark fill animation
- âœ… Streak counter increments with bounce
- âœ… Achievement unlock (scale + fade in)
- âœ… Smooth transitions between screens
- âœ… Swipe gestures (left: edit, right: complete)
- âœ… Pull-to-refresh on feed
- âœ… Skeleton loaders for async data

**Color Scheme (by habit category):**
- Health: Green (#10B981)
- Fitness: Red (#EF4444)
- Productivity: Blue (#3B82F6)
- Learning: Purple (#8B5CF6)
- Mindfulness: Indigo (#6366F1)
- Social: Pink (#EC4899)

---

### ğŸ§ª **Testing Strategy**

**Unit Tests:**
- Streak calculation algorithm (including streak freezes)
- Completion rate calculation
- Point earning logic
- Achievement unlock conditions
- Reminder time calculation (timezones)

**Integration Tests:**
- Real-time notification delivery (Pusher/Ably)
- Friend request flow (send â†’ accept â†’ show in friend list)
- Challenge creation and participation
- Habit check-in with optimistic UI

**E2E Tests:**
```typescript
test('User can create habit, check in, and see streak', async ({ page }) => {
  await page.goto('/habits')
  await page.click('text=Create Habit')
  await page.fill('[name="name"]', 'Morning Jog')
  await page.click('[data-icon="running"]')
  await page.selectOption('[name="frequency"]', 'daily')
  await page.click('text=Save')
  
  // Check in
  await page.goto('/today')
  await page.click('[data-habit="Morning Jog"] .checkbox')
  await expect(page.locator('text=ğŸ”¥ 1')).toBeVisible() // Streak = 1
  
  // Check confetti animation appeared
  await expect(page.locator('.confetti')).toBeVisible()
})

test('User can invite friend to accountability partnership', async ({ page }) => {
  // Login as User A
  await page.goto('/habits')
  await page.click('[data-habit="Morning Jog"]')
  await page.click('text=Add Accountability Partner')
  await page.fill('[name="friendEmail"]', 'friend@example.com')
  await page.click('text=Invite')
  
  // Login as User B (friend)
  // Accept invitation
  // Verify User A's habit appears in User B's accountability feed
})
```

**Performance Tests:**
- Feed load time with 100+ activities (pagination/infinite scroll)
- Calendar rendering (365 days of data)
- Real-time notification latency (should be < 1 second)

---

### ğŸ“Š **Success Metrics**

**Technical:**
- Real-time latency < 500ms (habit completion to friend notification)
- App load time < 2s
- Offline functionality (check-in queued, syncs when online)
- Push notification delivery rate > 95%

**User Engagement:**
- Daily Active Users (DAU)
- Habit completion rate (target: > 70%)
- Average check-ins per user per day (target: > 3)
- Streak retention (% users with streak > 7 days)
- Social features adoption (% users with friends)

**Retention:**
- Day 1 retention: > 60%
- Day 7 retention: > 40%
- Day 30 retention: > 30%
- Challenge completion rate: > 50%

---

### ğŸ”” **Notification Strategy**

**Push Notifications (via OneSignal/Pusher):**

**1. Habit Reminders:**
- Time-based: "Time to [habit name]!" (at scheduled time)
- Streak saver: "Don't break your ğŸ”¥ 15 streak! Check in before midnight"
- Personalized: "You usually [habit] at 7 AM. Ready?"

**2. Social Notifications:**
- "ğŸ‰ [Friend] just completed their 30-day streak for [habit]!"
- "ğŸ‘‹ [Friend] is encouraging you to complete [habit]"
- "ğŸ’ª [Friend] invited you to join the [challenge name] challenge"
- "â¤ï¸ [Friend] reacted to your achievement"

**3. Milestone Notifications:**
- "ğŸ”¥ Amazing! You've hit a 7-day streak for [habit]!"
- "ğŸ† Achievement Unlocked: Week Warrior"
- "ğŸ“ˆ You completed 80% of your habits this week - new record!"

**4. Engagement Notifications:**
- "ğŸ‘€ Your friend [Name] completed [habit]. Go cheer them on!"
- "ğŸ¯ You're #2 on the [challenge] leaderboard. One more day to win!"
- "âš¡ You have 500 points! Unlock a new theme?"

**Notification Settings (User Control):**
- âœ… Toggle all notifications
- âœ… Per-habit reminders
- âœ… Social activity notifications
- âœ… Milestone celebrations
- âœ… Friend requests
- âœ… Quiet hours (no notifications 10 PM - 8 AM)
- âœ… Notification sound
- âœ… Vibration

---

### ğŸš€ **Real-time Architecture (Pusher/Ably)**

**Real-time Events:**

**1. Habit Completion:**
```typescript
// When User A completes habit
pusher.trigger(`user-${userId}`, 'habit-completed', {
  habitId: 'habit_123',
  userId: 'user_A',
  habitName: 'Morning Jog',
  streak: 15,
  timestamp: new Date()
})

// All accountability partners of User A subscribe to this channel
// They receive instant notification
```

**2. Friend Activity Feed:**
```typescript
// When any friend completes a habit
pusher.trigger(`feed-${userId}`, 'friend-activity', {
  friendId: 'user_B',
  friendName: 'John',
  activityType: 'habit_completed',
  habitName: 'Meditation',
  timestamp: new Date()
})
```

**3. Challenge Updates:**
```typescript
// Real-time leaderboard updates
pusher.trigger(`challenge-${challengeId}`, 'leaderboard-updated', {
  rankings: [
    { userId: 'user_A', name: 'Alice', completions: 25 },
    { userId: 'user_B', name: 'Bob', completions: 23 },
    // ...
  ]
})
```

**4. Poke/Nudge:**
```typescript
// Instant delivery
pusher.trigger(`user-${friendId}`, 'friend-poke', {
  fromUserId: 'user_A',
  fromUserName: 'Alice',
  habitId: 'habit_123',
  habitName: 'Drink Water',
  message: 'Alice is encouraging you to Drink Water! ğŸ’§'
})
```

---

### ğŸ“± **Mobile-Specific Features**

**PWA Features:**
- âœ… Install prompt (Add to Home Screen)
- âœ… Offline check-in (queued, syncs when online)
- âœ… Background sync (Service Worker)
- âœ… Push notifications (even when app closed)
- âœ… Quick actions (long-press app icon â†’ "Check in", "View Stats")

**Mobile Gestures:**
- âœ… Swipe right to complete habit
- âœ… Swipe left to skip/snooze
- âœ… Pull down to refresh feed
- âœ… Long press habit to edit
- âœ… Swipe up on habit for details

**Home Screen Widget (future consideration):**
- Today's habits at a glance
- Check-in directly from widget
- Streak counter visible

---

### ğŸ® **Gamification Psychology**

**Motivation Triggers:**

**1. Progress Tracking:**
- Visual streaks (ğŸ”¥ fire emoji)
- Percentage completion
- "You're 2 days away from your longest streak!"

**2. Social Proof:**
- "85% of users complete habits in the morning"
- "Your friends average 4.2 habits per day"
- Leaderboards

**3. Loss Aversion:**
- "Don't break your 30-day streak!"
- Streak freeze as safety net
- Countdown timer "Check in within 2 hours"

**4. Variable Rewards:**
- Random achievement unlocks
- Surprise bonus points
- "Mystery reward at 100-day streak!"

**5. Commitment & Consistency:**
- Public habits (social pressure)
- Accountability partners
- Written goals/reasons for habits

**6. Social Connection:**
- See friends' progress
- Group challenges
- Encouragement messages
- Celebrate together

---

### ğŸ”’ **Privacy & Data Controls**

**User Privacy Options:**
- âœ… Private habits (only you can see)
- âœ… Friends-only habits (friends can see, but not public)
- âœ… Public habits (community can see)
- âœ… Anonymous mode (hide real name, use username)
- âœ… Disable friend requests
- âœ… Block users
- âœ… Delete all data (GDPR right to erasure)
- âœ… Export data (JSON/CSV)

**Data Security:**
- âœ… End-to-end encryption for private notes
- âœ… Rate limiting (prevent spam pokes)
- âœ… Report inappropriate behavior
- âœ… Moderation queue for public habits

---