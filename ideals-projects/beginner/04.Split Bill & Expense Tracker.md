

## ğŸ’° **PROJECT 4: Split Bill & Expense Tracker**

### ğŸ“– **Project Overview**
á»¨ng dá»¥ng chia bill thÃ´ng minh giÃºp nhÃ³m báº¡n tÃ­nh toÃ¡n ai ná»£ ai bao nhiÃªu sau chuyáº¿n Ä‘i chÆ¡i, Ä‘i Äƒn, hoáº·c du lá»‹ch chung. Sá»­ dá»¥ng thuáº­t toÃ¡n tá»‘i Æ°u hÃ³a Ä‘á»ƒ giáº£m sá»‘ lÆ°á»£ng giao dá»‹ch thanh toÃ¡n. Giáº£i quyáº¿t váº¥n Ä‘á»: "Sau chuyáº¿n Ä‘i nhÃ³m, lÃ m sao chia tiá»n cho cÃ´ng báº±ng vÃ  Ä‘Æ¡n giáº£n?"

### ğŸ¯ **Target Users**
- NhÃ³m báº¡n Ä‘i du lá»‹ch chung
- Báº¡n cÃ¹ng phÃ²ng chia tiá»n thuÃª nhÃ , Ä‘iá»‡n nÆ°á»›c
- Äá»“ng nghiá»‡p Ä‘i Äƒn trÆ°a chung
- Cáº·p Ä‘Ã´i muá»‘n quáº£n lÃ½ chi tiÃªu chung
- Gia Ä‘Ã¬nh chia tiá»n mua sáº¯m

### ğŸš€ **MVP - Week 1-2 (Core Features)**

**User Story 1: Create Group**
```
AS A user
I WANT TO create an expense group
SO THAT we can track shared expenses
```
**Acceptance Criteria:**
- âœ… Group name (e.g., "ÄÃ  Láº¡t Trip 2024")
- âœ… Group description (optional)
- âœ… Group avatar/cover image
- âœ… Add members (by email, phone, or username)
- âœ… Set default currency (VND, USD, EUR, etc.)
- âœ… Group creator becomes admin
- âœ… Generate shareable invite link
- âœ… QR code for quick join

**User Story 2: Add Expense**
```
AS A user
I WANT TO record a shared expense
SO THAT everyone knows who paid and who owes
```
**Acceptance Criteria:**
- âœ… Expense description ("Dinner at NhÃ  HÃ ng")
- âœ… Total amount
- âœ… Who paid? (select from group members)
- âœ… Split method:
  - Equal split (divide evenly)
  - Exact amounts (each person custom amount)
  - Percentages (each person %)
  - Shares (1 person = 1 share, 2 shares for couples)
- âœ… Who participated? (select subset of group)
- âœ… Date (default: today)
- âœ… Category (Food, Transport, Accommodation, Entertainment, Other)
- âœ… Receipt photo (optional)
- âœ… Notes (optional)

**User Story 3: View Balances**
```
AS A user
I WANT TO see who owes whom
SO THAT I know how much to pay/receive
```
**Acceptance Criteria:**
- âœ… **Overview Card**: "You owe [amount]" or "You are owed [amount]"
- âœ… **Detailed Balances**: 
  - "You owe Alice 500,000â‚«"
  - "Bob owes you 300,000â‚«"
- âœ… Net balance (total you owe - total owed to you)
- âœ… Visual indicator (red for debt, green for credit)
- âœ… Tap to see transaction history with that person

**User Story 4: Settle Debt**
```
AS A user
I WANT TO record a payment
SO THAT balances are updated
```
**Acceptance Criteria:**
- âœ… Record payment: From [person] to [person], Amount
- âœ… Payment method (Cash, Bank Transfer, Momo, ZaloPay, etc.)
- âœ… Payment proof (screenshot, photo)
- âœ… Payment note
- âœ… Auto-update balances
- âœ… Notification to recipient
- âœ… Confirm receipt (recipient verifies)

**User Story 5: Expense List & History**
```
AS A user
I WANT TO see all group expenses
SO THAT I can review spending
```
**Acceptance Criteria:**
- âœ… List all expenses (newest first)
- âœ… Show: Description, Amount, Paid by, Date, Category icon
- âœ… Filter by: Category, Date range, Who paid, Who participated
- âœ… Search by description
- âœ… Total expenses summary
- âœ… Tap expense to see split details
- âœ… Edit expense (only creator or admin)
- âœ… Delete expense (only creator or admin, with confirmation)

**Database Schema (MVP):**
```prisma
model User {
  id            String          @id @default(cuid())
  email         String?         @unique
  phone         String?         @unique
  name          String
  avatar        String?
  groupMembers  GroupMember[]
  expenses      Expense[]       // Expenses user paid for
  balances      Balance[]       @relation("UserBalances")
  payments      Payment[]       @relation("PaymentFrom")
  receivedPayments Payment[]    @relation("PaymentTo")
  createdAt     DateTime        @default(now())
}

model Group {
  id            String        @id @default(cuid())
  name          String
  description   String?
  avatar        String?
  currency      String        @default("VND")
  inviteCode    String        @unique
  members       GroupMember[]
  expenses      Expense[]
  balances      Balance[]
  payments      Payment[]
  createdBy     String
  createdAt     DateTime      @default(now())
}

model GroupMember {
  id        String   @id @default(cuid())
  groupId   String
  userId    String
  role      String   // "admin" | "member"
  joinedAt  DateTime @default(now())
  
  @@unique([groupId, userId])
}

model Expense {
  id            String          @id @default(cuid())
  groupId       String
  description   String
  totalAmount   Decimal         @db.Decimal(12, 2)
  currency      String          @default("VND")
  paidBy        String          // User ID
  splitMethod   String          // "equal" | "exact" | "percentage" | "shares"
  category      String
  date          DateTime
  receiptUrl    String?
  notes         String?
  splits        ExpenseSplit[]
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
}

model ExpenseSplit {
  id          String   @id @default(cuid())
  expenseId   String
  userId      String
  amount      Decimal  @db.Decimal(12, 2)  // How much this person owes
  percentage  Decimal? @db.Decimal(5, 2)    // If split by percentage
  shares      Int?                           // If split by shares
  
  @@unique([expenseId, userId])
}

model Balance {
  id        String   @id @default(cuid())
  groupId   String
  fromUser  String   // User who owes
  toUser    String   // User who is owed
  amount    Decimal  @db.Decimal(12, 2)
  currency  String   @default("VND")
  updatedAt DateTime @updatedAt
  
  @@unique([groupId, fromUser, toUser])
}

model Payment {
  id            String   @id @default(cuid())
  groupId       String
  fromUser      String
  toUser        String
  amount        Decimal  @db.Decimal(12, 2)
  currency      String   @default("VND")
  method        String   // "cash" | "bank_transfer" | "momo" | "zalopay"
  proofUrl      String?
  note          String?
  status        String   // "pending" | "confirmed" | "disputed"
  createdAt     DateTime @default(now())
}
```

---

### ğŸ“ˆ **Phase 2 - Week 3 (Advanced Features)**

**Feature 1: Debt Simplification Algorithm**
```
AS A user
I WANT TO minimize the number of transactions needed to settle
SO THAT settling up is simpler
```

**Problem Example:**
```
Before Simplification:
- Alice owes Bob 100â‚«
- Bob owes Charlie 100â‚«
- Alice owes Charlie 50â‚«

After Simplification:
- Alice owes Charlie 150â‚«
(Bob is removed from transactions!)
```

**Acceptance Criteria:**
- âœ… Implement graph-based debt simplification algorithm
- âœ… "Simplify Debts" button
- âœ… Show before/after comparison (X transactions â†’ Y transactions)
- âœ… Explain savings (e.g., "Saved 3 transactions!")
- âœ… Suggest optimal payment plan
- âœ… Settlement suggestions: "Alice should pay Charlie 150â‚«"

**Feature 2: Multi-Currency Support**
```
AS A user traveling internationally
I WANT TO handle multiple currencies
SO THAT I accurately track expenses abroad
```
**Acceptance Criteria:**
- âœ… Add expense in any currency
- âœ… Auto-convert to group's default currency (exchange rate API)
- âœ… Show original currency + converted amount
- âœ… Historical exchange rates (date of expense)
- âœ… Manual exchange rate override (if needed)
- âœ… Currency breakdown chart (spent X in USD, Y in VND, etc.)

**Feature 3: Receipt Scanning (OCR)**
```
AS A user
I WANT TO scan receipts to auto-fill expense details
SO THAT I save time entering data
```
**Acceptance Criteria:**
- âœ… Camera capture or upload receipt image
- âœ… OCR extract: Total amount, Date, Merchant name
- âœ… Pre-fill expense form with extracted data
- âœ… User can review/edit before saving
- âœ… Store original receipt image
- âœ… Support multiple receipt formats (restaurant, taxi, hotel, etc.)
- âœ… Use Tesseract.js (client-side OCR) or Google Vision API

**Feature 4: Recurring Expenses**
```
AS A user sharing apartment costs
I WANT TO set up recurring expenses
SO THAT monthly bills are auto-added
```
**Acceptance Criteria:**
- âœ… Mark expense as recurring
- âœ… Set frequency: Weekly, Monthly, Yearly
- âœ… Set end date or "ongoing"
- âœ… Auto-create expense on due date (cron job)
- âœ… Notification before auto-creation
- âœ… Edit/Delete recurring expense template
- âœ… View upcoming recurring expenses

**Feature 5: Expense Categories & Analytics**
```
AS A user
I WANT TO see spending breakdown by category
SO THAT I understand where money went
```
**Acceptance Criteria:**
- âœ… Pie chart: Expense by category
- âœ… Bar chart: Spending over time (daily, weekly, monthly)
- âœ… Top spenders in group
- âœ… Most expensive expense
- âœ… Average expense per person
- âœ… Category trends (spent more/less than last month)
- âœ… Export report (PDF with charts)

**Feature 6: Activity Feed**
```
AS A user
I WANT TO see recent group activity
SO THAT I stay updated
```
**Acceptance Criteria:**
- âœ… Real-time feed: "[Alice] added expense 'Dinner' (500,000â‚«)"
- âœ… "[Bob] paid [Alice] 200,000â‚«"
- âœ… "[Charlie] joined the group"
- âœ… "[Alice] edited expense 'Taxi'"
- âœ… Timestamp (e.g., "2 hours ago")
- âœ… Push notifications for important events
- âœ… Filter feed (Expenses only, Payments only, All)

---

### ğŸš€ **Phase 3 - Week 4 (Expert Features)**

**Feature 1: Advanced Split Methods**

**1. Itemized Split (Restaurant Bill):**
```
AS A user
I WANT TO split
```