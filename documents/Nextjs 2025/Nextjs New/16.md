**📘 Multiple Root Layouts (Nhiều Root Layouts)** — một tính năng nâng cao giúp bạn tạo **nhiều khu vực tách biệt hoàn toàn trong cùng ứng dụng** Next.js.

---

# 🎯 Mục tiêu

* Hiểu sự khác biệt giữa **layout lồng nhau (nested)** và **multiple root layouts**
* Biết khi nào nên dùng **multiple root layout** thay vì **nested layout**
* Thực hành tạo **app/(auth)** và **app/(main)** tách biệt giao diện

---

## 🧩 1️⃣ Vấn đề thực tế

Trong các ứng dụng lớn, bạn có nhiều khu vực tách biệt:

* Khu vực **public** (home, about, contact)
* Khu vực **authenticated** (dashboard, profile)
* Khu vực **auth** (login, register, forgot password)

Mỗi khu vực có **layout riêng biệt**, không kế thừa `RootLayout` chung.
Ví dụ:

* Khu vực đăng nhập không có header, sidebar
* Dashboard có sidebar riêng
* Public pages dùng layout khác

---

## 🧱 2️⃣ Giải pháp — Route Groups & Multiple Root Layouts

Bạn có thể dùng **Route Groups** để tách layout gốc, ví dụ:

```
app/
├── (main)/
│   ├── layout.tsx      ← Root layout cho trang public
│   ├── page.tsx
│   └── about/
│       └── page.tsx
├── (dashboard)/
│   ├── layout.tsx      ← Root layout riêng cho dashboard
│   ├── page.tsx
│   └── settings/
│       └── page.tsx
└── (auth)/
    ├── layout.tsx      ← Root layout riêng cho login/register
    ├── login/
    │   └── page.tsx
    └── register/
        └── page.tsx
```

---

## ⚙️ 3️⃣ Ví dụ thực tế

### 📄 `app/(main)/layout.tsx`

```tsx
import Link from "next/link";

export default function MainLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body className="bg-gray-50 text-gray-900">
        <header className="p-4 bg-white border-b shadow">
          <nav className="flex gap-4">
            <Link href="/">Home</Link>
            <Link href="/about">About</Link>
            <Link href="/dashboard">Dashboard</Link>
          </nav>
        </header>
        <main className="p-6">{children}</main>
      </body>
    </html>
  );
}
```

---

### 📄 `app/(main)/page.tsx`

```tsx
export default function HomePage() {
  return (
    <section>
      <h1 className="text-2xl font-bold">🏠 Home Page</h1>
      <p>Welcome to our main site!</p>
    </section>
  );
}
```

---

### 📄 `app/(dashboard)/layout.tsx`

```tsx
import Link from "next/link";

export default function DashboardLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body className="flex min-h-screen">
        <aside className="w-64 bg-gray-100 p-6 border-r">
          <h2 className="text-lg font-bold mb-4">📊 Dashboard</h2>
          <nav className="flex flex-col gap-2">
            <Link href="/dashboard">Overview</Link>
            <Link href="/dashboard/settings">Settings</Link>
          </nav>
        </aside>
        <main className="flex-1 p-8 bg-white">{children}</main>
      </body>
    </html>
  );
}
```

---

### 📄 `app/(auth)/layout.tsx`

```tsx
export default function AuthLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body className="flex items-center justify-center min-h-screen bg-gray-100">
        <div className="bg-white p-8 rounded shadow-md w-full max-w-md">
          {children}
        </div>
      </body>
    </html>
  );
}
```

---

### 📄 `app/(auth)/login/page.tsx`

```tsx
export default function LoginPage() {
  return (
    <form className="flex flex-col gap-4">
      <h1 className="text-xl font-semibold">🔐 Login</h1>
      <input type="email" placeholder="Email" className="border p-2 rounded" />
      <input type="password" placeholder="Password" className="border p-2 rounded" />
      <button className="bg-blue-500 text-white p-2 rounded hover:bg-blue-600">Sign In</button>
    </form>
  );
}
```

---

## 🧠 4️⃣ Cách hoạt động

* Mỗi nhóm route `(main)`, `(dashboard)`, `(auth)` có **layout.tsx riêng**, **độc lập hoàn toàn**
* Next.js **không gộp layout giữa các nhóm này**
* Khi chuyển từ `/dashboard` sang `/login`, layout **bị thay đổi hoàn toàn** (reset DOM, không reuse layout)

---

## ⚡ 5️⃣ Khi nào nên dùng Multiple Root Layouts

✅ Khi các khu vực **không có cấu trúc giao diện chung**
✅ Khi cần **reset trạng thái UI hoặc Context riêng biệt**
✅ Khi muốn **tách biệt rõ ràng public / private / auth zone**

---

## 💬 6️⃣ Bài tập

Tạo cấu trúc:

```
app/
├── (public)/
│   ├── layout.tsx
│   ├── page.tsx
│   └── about/page.tsx
├── (auth)/
│   ├── layout.tsx
│   ├── login/page.tsx
│   └── register/page.tsx
```

→ Khi truy cập `/login`, layout auth hiển thị riêng biệt (trung tâm, trắng sạch).
→ Khi truy cập `/about`, dùng layout public (header + nav).

---
[<< BÀI 15](./15.md) | [BÀI 17 >>](./17.md)