**📘 Routing Metadata** — chủ đề quan trọng giúp bạn **tùy chỉnh tiêu đề, mô tả, favicon, SEO tags**… cho từng route trong **App Router** của Next.js.

---

## 🎯 Mục tiêu

* Hiểu cách Next.js quản lý **Metadata API**
* Biết cách khai báo **metadata tĩnh & động**
* Hiểu metadata hoạt động **trong layout và page**
* Thực hành đặt **title, description, icons, open graph** cho từng route

---

## 🧩 1️⃣ Metadata là gì?

**Metadata** là dữ liệu mô tả nội dung của trang — ví dụ:

```html
<title>Next.js Blog - Home</title>
<meta name="description" content="A modern blog built with Next.js 15" />
<meta property="og:image" content="/og-image.png" />
```

Thay vì phải tự thêm thủ công trong `<head>`, Next.js cung cấp **Metadata API** giúp bạn quản lý dễ dàng và tự động hóa SEO.

---

## 🧱 2️⃣ Cấu trúc cơ bản

Metadata có thể được khai báo ở:

* `layout.tsx`
* `page.tsx`
* hoặc `generateMetadata()` (dành cho metadata động)

Cấu trúc:

```tsx
export const metadata = {
  title: "Trang chủ | Next.js App",
  description: "Ứng dụng demo Next.js với App Router.",
};
```

---

## ⚙️ 3️⃣ Ví dụ cơ bản

### 📄 `app/page.tsx`

```tsx
export const metadata = {
  title: "🏠 Trang chủ | Next.js App",
  description: "Trang chủ của ứng dụng Next.js App Router",
};

export default function HomePage() {
  return (
    <section>
      <h1>Xin chào 👋</h1>
      <p>Đây là trang chủ của bạn.</p>
    </section>
  );
}
```

➡ Kết quả:
Next.js tự động thêm vào `<head>`:

```html
<title>🏠 Trang chủ | Next.js App</title>
<meta name="description" content="Trang chủ của ứng dụng Next.js App Router">
```

---

## 🧠 4️⃣ Metadata trong `layout.tsx`

Khai báo metadata tại layout áp dụng **cho toàn bộ nhánh route con**:

### 📄 `app/(main)/layout.tsx`

```tsx
export const metadata = {
  title: {
    default: "Next.js Demo",
    template: "%s | Next.js Demo",
  },
  description: "Trang chính của ứng dụng Next.js",
};
```

→ Nếu `page.tsx` có `title: "Dashboard"`, kết quả sẽ là:

```
<title>Dashboard | Next.js Demo</title>
```

---

## ⚡ 5️⃣ Metadata động với `generateMetadata()`

Khi cần tạo **metadata phụ thuộc vào dữ liệu** (ví dụ: blog post, sản phẩm), dùng:

### 📄 `app/blog/[slug]/page.tsx`

```tsx
type Props = { params: { slug: string } };

export async function generateMetadata({ params }: Props) {
  const post = await getPostBySlug(params.slug);
  return {
    title: `${post.title} | Next.js Blog`,
    description: post.excerpt,
    openGraph: {
      images: [post.coverImage],
    },
  };
}

export default function BlogPost({ params }: Props) {
  return <article>...</article>;
}
```

➡ Giúp **SEO động** theo từng bài viết.

---

## 🖼️ 6️⃣ Metadata mở rộng

Bạn có thể thêm nhiều loại metadata khác:

```tsx
export const metadata = {
  title: "About Us",
  description: "Giới thiệu về công ty NextX",
  openGraph: {
    title: "NextX – Giới thiệu",
    description: "Xây dựng sản phẩm web hiện đại",
    url: "https://nextx.vn/about",
    siteName: "NextX",
    images: [
      {
        url: "/og-image.png",
        width: 1200,
        height: 630,
      },
    ],
  },
  twitter: {
    card: "summary_large_image",
    title: "NextX – About",
    description: "Giới thiệu về NextX",
    images: ["/og-image.png"],
  },
  icons: {
    icon: "/favicon.ico",
  },
};
```

---

## 📚 7️⃣ Thứ tự ưu tiên Metadata

1️⃣ `page.tsx` (nếu có `metadata` hoặc `generateMetadata`)
2️⃣ `layout.tsx` cùng cấp
3️⃣ `Root layout` (`app/layout.tsx`)

➡ Next.js sẽ **merge** metadata theo cây layout từ trên xuống.

---

## 🧠 8️⃣ Khi nào nên dùng loại nào

| Trường hợp                     | Cách dùng                                  |
| ------------------------------ | ------------------------------------------ |
| Trang cố định (Home, About)    | `export const metadata`                    |
| Trang động (Blog, Product)     | `export async function generateMetadata()` |
| Metadata chung cho toàn app    | Khai báo tại `app/layout.tsx`              |
| Metadata riêng từng nhóm route | Đặt tại `app/(group)/layout.tsx`           |

---

## 💬 9️⃣ Bài tập

Tạo cấu trúc:

```
app/
├── (main)/
│   ├── layout.tsx
│   ├── page.tsx
│   └── about/page.tsx
└── blog/
    ├── [slug]/
    │   └── page.tsx
```

Yêu cầu:

* `layout.tsx` có metadata mặc định `Next.js Course`
* `about/page.tsx` có title riêng `"Về chúng tôi"`
* `blog/[slug]/page.tsx` sinh metadata động theo `slug`


---
[<< BÀI 16](./16.md) | [BÀI 18 >>](./18.md)