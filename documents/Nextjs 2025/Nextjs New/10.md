## 🧭 Not Found Page trong Next.js

### 🎯 Mục tiêu

* Hiểu cách hoạt động của `not-found.tsx`
* Phân biệt **not-found toàn cục (global)** và **not-found cục bộ (nested)**
* Biết cách sử dụng hàm `notFound()` để trigger 404 tùy ý trong server component.

---

## 🧱 1️⃣ Khái niệm cơ bản

Trong App Router, bạn chỉ cần tạo file đặc biệt có tên:

```
app/not-found.tsx
```

hoặc trong bất kỳ thư mục route nào, ví dụ:

```
app/dashboard/not-found.tsx
```

Next.js sẽ tự động render trang này khi:

* Người dùng truy cập route không tồn tại.
* Hoặc bạn **chủ động gọi** `notFound()` trong code (ví dụ khi không tìm thấy dữ liệu).

---

## 📄 2️⃣ Global Not Found Page

### 🔹 `app/not-found.tsx`

```tsx
// app/not-found.tsx
export default function NotFound() {
  return (
    <div
      style={{
        padding: "2rem",
        textAlign: "center",
        color: "#555",
      }}
    >
      <h1>🚫 404 — Page Not Found</h1>
      <p>The page you are looking for doesn’t exist or has been moved.</p>
      <a
        href="/"
        style={{
          marginTop: "1rem",
          display: "inline-block",
          textDecoration: "underline",
        }}
      >
        ← Go back to Home
      </a>
    </div>
  );
}
```

➡ Khi người dùng vào `/abcxyz` (không có route), Next.js sẽ tự động hiển thị file này.

---

## 📂 3️⃣ Nested Not Found Page

Bạn có thể tạo file `not-found.tsx` trong một route cụ thể, ví dụ:

```
app/dashboard/
├── layout.tsx
├── page.tsx
└── not-found.tsx
```

### 🔹 `app/dashboard/not-found.tsx`

```tsx
export default function DashboardNotFound() {
  return (
    <div>
      <h2>❌ Dashboard Section Not Found</h2>
      <p>The requested dashboard page does not exist.</p>
    </div>
  );
}
```

➡ Lúc này, `/dashboard/invalid-page` sẽ hiển thị trang này **thay vì global 404.**

---

## ⚙️ 4️⃣ Trigger 404 thủ công bằng `notFound()`

Bạn có thể import và gọi hàm `notFound()` trong **server component** khi không tìm thấy dữ liệu.

```tsx
// app/products/[id]/page.tsx
import { notFound } from "next/navigation";

export default async function ProductPage({
  params,
}: {
  params: { id: string };
}) {
  const res = await fetch(`https://api.example.com/products/${params.id}`);

  if (!res.ok) {
    notFound(); // 🔥 Gọi 404 thủ công
  }

  const product = await res.json();

  return (
    <div>
      <h1>{product.name}</h1>
      <p>Price: ${product.price}</p>
    </div>
  );
}
```

---

## 🧩 5️⃣ Cơ chế render 404 trong App Router

Thứ tự ưu tiên của Next.js khi render `not-found`:

1. Nếu route có file `not-found.tsx` cục bộ → dùng file đó.
2. Nếu không, tìm file `not-found.tsx` ở cấp cao hơn (layout cha).
3. Nếu không có → fallback sang `app/not-found.tsx` (global).
4. Nếu vẫn không có → render mặc định trang 404 mặc định của Next.js.

---

## 💬 6️⃣ Bài tập nhỏ

> Tạo cấu trúc `/blog/[slug]`:
>
> * Nếu slug không tồn tại trong danh sách giả lập (`["nextjs", "react", "tailwind"]`), gọi `notFound()`.
> * Thêm `not-found.tsx` riêng cho `/blog` hiển thị “Bài viết không tồn tại”.

---

[<< BÀI 09](./09.md) | [BÀI 11 >>](./11.md)