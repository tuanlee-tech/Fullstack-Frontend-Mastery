# Ngày 15

## Lớp (Classes)

JavaScript là ngôn ngữ lập trình hướng đối tượng. Mọi thứ trong JavaScript đều là đối tượng, với các thuộc tính và phương thức. Lớp (class) là bản thiết kế để tạo ra các đối tượng. Chúng ta sử dụng lớp để định nghĩa các thuộc tính và hành vi của đối tượng, sau đó khởi tạo đối tượng từ lớp.

### Định nghĩa lớp (Defining a Classes)

Sử dụng từ khóa `class`, tên lớp theo **CamelCase**, và khối mã trong cặp dấu ngoặc nhọn.

```js
class Person {
  // mã ở đây
}
```

### Khởi tạo lớp (Class Instantiation)

Sử dụng từ khóa `new` để tạo đối tượng từ lớp.

```js
class Person {
  // mã ở đây
}
const person = new Person()
console.log(person) // Person {}
```

### Constructor của lớp (Class Constructor)

Phương thức `constructor` dùng để định nghĩa các thuộc tính ban đầu của đối tượng, sử dụng từ khóa `this` để gắn thuộc tính vào lớp.

```js
class Person {
  constructor(firstName, lastName) {
    this.firstName = firstName
    this.lastName = lastName
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh')
console.log(person1) // Person { firstName: "Asabeneh", lastName: "Yetayeh" }
```

Tạo nhiều đối tượng từ lớp:

```js
const person1 = new Person('Asabeneh', 'Yetayeh')
const person2 = new Person('Lidiya', 'Tekle')
console.log(person1) // Person { firstName: "Asabeneh", lastName: "Yetayeh" }
console.log(person2) // Person { firstName: "Lidiya", lastName: "Tekle" }
```

Thêm thuộc tính:

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
console.log(person1) // Person { firstName: "Asabeneh", lastName: "Yetayeh", age: 250, country: "Finland", city: "Helsinki" }
```

### Giá trị mặc định trong constructor

Có thể gán giá trị mặc định cho các thuộc tính:

```js
class Person {
  constructor(firstName = 'Asabeneh', lastName = 'Yetayeh', age = 250, country = 'Finland', city = 'Helsinki') {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
  }
}
const person1 = new Person() // Sử dụng giá trị mặc định
const person2 = new Person('Lidiya', 'Tekle', 28, 'Finland', 'Espoo')
console.log(person1) // Person { firstName: "Asabeneh", lastName: "Yetayeh", age: 250, country: "Finland", city: "Helsinki" }
console.log(person2) // Person { firstName: "Lidiya", lastName: "Tekle", age: 28, country: "Finland", city: "Espoo" }
```

### Phương thức của lớp (Class Methods)

Phương thức là các hàm trong lớp.

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
  }
  getFullName() {
    return `${this.firstName} ${this.lastName}`
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
console.log(person1.getFullName()) // Asabeneh Yetayeh
```

### Thuộc tính với giá trị ban đầu

Có thể gán giá trị ban đầu cho thuộc tính:

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
    this.score = 0
    this.skills = []
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
console.log(person1.score) // 0
console.log(person1.skills) // []
```

### Getter

Phương thức `get` cho phép truy cập giá trị thuộc tính mà không cần gọi hàm.

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
    this.score = 0
    this.skills = []
  }
  get getScore() {
    return this.score
  }
  get getSkills() {
    return this.skills
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
console.log(person1.getScore) // 0
console.log(person1.getSkills) // []
```

### Setter

Phương thức `set` cho phép thay đổi giá trị thuộc tính.

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
    this.score = 0
    this.skills = []
  }
  set setScore(score) {
    this.score += score
  }
  set setSkill(skill) {
    this.skills.push(skill)
  }
}
const person1 = new Person('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
person1.setScore = 1
person1.setSkill = 'HTML'
console.log(person1.score) // 1
console.log(person1.skills) // ["HTML"]
```

### Phương thức tĩnh (Static Method)

Phương thức `static` được gọi trực tiếp từ lớp, không cần khởi tạo đối tượng.

```js
class Person {
  constructor(firstName, lastName, age, country, city) {
    this.firstName = firstName
    this.lastName = lastName
    this.age = age
    this.country = country
    this.city = city
  }
  static favoriteSkill() {
    const skills = ['HTML', 'CSS', 'JS', 'React', 'Python', 'Node']
    return skills[Math.floor(Math.random() * skills.length)]
  }
}
console.log(Person.favoriteSkill()) // Ví dụ: "JS"
```

### Kế thừa (Inheritance)

Lớp con kế thừa tất cả thuộc tính và phương thức của lớp cha bằng từ khóa `extends`.

```js
class Student extends Person {
  saySomething() {
    console.log('I am a child of the person class')
  }
}
const s1 = new Student('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki')
console.log(s1.getFullName()) // Asabeneh Yetayeh
console.log(s1.saySomething()) // I am a child of the person class
```

### Ghi đè phương thức (Overriding Methods)

Lớp con có thể ghi đè phương thức của lớp cha.

```js
class Student extends Person {
  constructor(firstName, lastName, age, country, city, gender) {
    super(firstName, lastName, age, country, city)
    this.gender = gender
  }
  getPersonInfo() {
    let pronoun = this.gender === 'Male' ? 'He' : 'She'
    return `${this.getFullName()} is ${this.age}. ${pronoun} lives in ${this.city}, ${this.country}.`
  }
}
const s1 = new Student('Asabeneh', 'Yetayeh', 250, 'Finland', 'Helsinki', 'Male')
console.log(s1.getPersonInfo()) // Asabeneh Yetayeh is 250. He lives in Helsinki, Finland.
```

---

## Bài tập: Ngày 15

### Bài tập: Cấp độ 1

1. **Tạo lớp Animal**

```js
class Animal {
  constructor(name, age, color, legs) {
    this.name = name
    this.age = age
    this.color = color
    this.legs = legs
  }
  getInfo() {
    return `${this.name} is a ${this.color} animal, ${this.age} years old with ${this.legs} legs.`
  }
}
const dog = new Animal('Dog', 5, 'Brown', 4)
console.log(dog.getInfo()) // Dog is a Brown animal, 5 years old with 4 legs.
```

2. **Tạo lớp con Dog và Cat**

```js
class Dog extends Animal {
  bark() {
    return 'Woof!'
  }
}
class Cat extends Animal {
  meow() {
    return 'Meow!'
  }
}
const dog = new Dog('Dog', 5, 'Brown', 4)
const cat = new Cat('Cat', 3, 'White', 4)
console.log(dog.bark()) // Woof!
console.log(cat.meow()) // Meow!
```

### Bài tập: Cấp độ 2

1. **Ghi đè phương thức**

```js
class Dog extends Animal {
  getInfo() {
    return `${this.name} is a ${this.color} dog, ${this.age} years old with ${this.legs} legs.`
  }
}
const dog = new Dog('Dog', 5, 'Brown', 4)
console.log(dog.getInfo()) // Dog is a Brown dog, 5 years old with 4 legs.
```

### Bài tập: Cấp độ 3

1. **Tạo lớp Statistics**

```js
class Statistics {
  constructor(data) {
    this.data = data.sort((a, b) => a - b)
  }
  count() {
    return this.data.length
  }
  sum() {
    return this.data.reduce((sum, num) => sum + num, 0)
  }
  min() {
    return this.data[0]
  }
  max() {
    return this.data[this.data.length - 1]
  }
  range() {
    return this.max() - this.min()
  }
  mean() {
    return Math.round(this.sum() / this.count())
  }
  median() {
    const mid = Math.floor(this.count() / 2)
    return this.count() % 2 === 0 ? (this.data[mid - 1] + this.data[mid]) / 2 : this.data[mid]
  }
  mode() {
    const freq = this.data.reduce((acc, num) => {
      acc[num] = (acc[num] || 0) + 1
      return acc
    }, {})
    const maxCount = Math.max(...Object.values(freq))
    const mode = Object.keys(freq).find(key => freq[key] === maxCount)
    return { mode: Number(mode), count: maxCount }
  }
  var() {
    const mean = this.mean()
    const variance = this.data.reduce((sum, num) => sum + (num - mean) ** 2, 0) / this.count()
    return Math.round(variance * 10) / 10
  }
  std() {
    return Math.round(Math.sqrt(this.var()) * 10) / 10
  }
  freqDist() {
    const freq = this.data.reduce((acc, num) => {
      acc[num] = (acc[num] || 0) + 1
      return acc
    }, {})
    return Object.entries(freq)
      .map(([num, count]) => [(count / this.count() * 100).toFixed(1), Number(num)])
      .sort((a, b) => b[0] - a[0])
  }
  describe() {
    return `
      Count: ${this.count()}
      Sum: ${this.sum()}
      Min: ${this.min()}
      Max: ${this.max()}
      Range: ${this.range()}
      Mean: ${this.mean()}
      Median: ${this.median()}
      Mode: (${this.mode().mode}, ${this.mode().count})
      Variance: ${this.var()}
      Standard Deviation: ${this.std()}
      Frequency Distribution: ${JSON.stringify(this.freqDist())}`
  }
}
const ages = [31, 26, 34, 37, 27, 26, 32, 32, 26, 27, 27, 24, 32, 33, 27, 25, 26, 38, 37, 31, 34, 24, 33, 29, 26]
const statistics = new Statistics(ages)
console.log(statistics.describe())
```

2. **Tạo lớp PersonAccount**

```js
class PersonAccount {
  constructor(firstName, lastName) {
    this.firstName = firstName
    this.lastName = lastName
    this.incomes = []
    this.expenses = []
  }
  totalIncome() {
    return this.incomes.reduce((sum, { amount }) => sum + amount, 0)
  }
  totalExpense() {
    return this.expenses.reduce((sum, { amount }) => sum + amount, 0)
  }
  accountInfo() {
    return `${this.firstName} ${this.lastName} has a balance of ${this.accountBalance()}. Total income: ${this.totalIncome()}, Total expense: ${this.totalExpense()}`
  }
  addIncome(amount, description) {
    this.incomes.push({ amount, description })
  }
  addExpense(amount, description) {
    this.expenses.push({ amount, description })
  }
  accountBalance() {
    return this.totalIncome() - this.totalExpense()
  }
}
const account = new PersonAccount('Asabeneh', 'Yetayeh')
account.addIncome(1000, 'Salary')
account.addIncome(500, 'Freelance')
account.addExpense(300, 'Rent')
console.log(account.accountInfo()) // Asabeneh Yetayeh has a balance of 1200. Total income: 1500, Total expense: 300
```

---

[<< Ngày 14](./14.Error_Handling.md) | [Ngày 16 >>](./16.JSON.md)